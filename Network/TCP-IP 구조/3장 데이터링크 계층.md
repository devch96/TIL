# 데이터링크 계층

- 데이터링크 계층은 같은 네트워크에 있는 단말을 식별하고 물리 계층 위에서 비트열을 정확히 전송하는 구조를 제공함
- 데이터링크 계층은 디지털 데이터 전체의 정합성을 체크함으로써 물리 계층만으로는 정정할 수 없는 에러를 감지하고 디지털 데이터의
신뢰성을 담보함
- MAC 주소라는 네트워크상의 주소를 사용해서 송신 단말과 수신 단말을 식별함

------------

## 유선 LAN(IEEE802.3)

- 데이터링크란 인접한 기기 사이에 만드는 논리적인 전송로
- 데이터링크 계층은 어떤 단말에 대해 논리적인 전송로를 만드는가, 그리고 만들어진 링크 안에 비트가 누락되지는 않았는가를 판단하기 위해
캡슐화 처리로 물리 계층의 신뢰성을 확보함

### 이더넷의 프레임 포맷

- 이더넷에 의해 캡슐화된 패킷을 이더넷 프레임이라 부름
  - 이더넷 II 규약을 사용함
- 이더넷 II의 프레임 포맷은 프리앰블, 수신지/송신지 MAC 주소, 타입, 이더넷 페이로드, FCS 라는 5개 필드로 구성됨
  - 프리앰블, 수/송신지 MAC 주소, 타입을 합쳐 이더넷 헤더라 부름
  - FCS는 이더넷 트레일러라 부르기도 함

#### 프리앰블

- '이제부터 이더넷 프레임을 보낸다' 라는 합의를 의미하는 8바이트(64비트)의 특별한 비트 패턴
  - 앞에서부터 '10101010'을 7개(8*7=56), '10101011'을 1개(8) 보냄
- 수신 측 단말은 이더넷 프레임 최초에 부여되어 있는 이 특별한 비트 패턴을 보고 이제부터 이더넷 프레임이 온다라고 판단함

#### 수신지/송신지 MAC 주소

- MAC은 이더넷 네트워크에 접속하고 있는 단말을 식별하는 6바이트(48비트) ID
  - 주소와 같은 것
- 수신 측 단말은 수신지 MAC 주소를 보고 자신의 MAC 주소라면 해당 프레임을 받고 관계없는 MAC 주소라면 파기함

#### 타입

- 타입은 네트워크 계층(L3)에서 어떤 프로토콜을 사용하는지 나타내는 2바이트의 ID
- 사용하는 프로토콜이나 그 버전 등에 따라 값이 결정됨

#### 이더넷 페이로드

- 네트워크 계층의 데이터 자체를 나타냄
  - 이더넷 페이로드 = IP 패킷
- 디폴트로 46바이트부터 1,500 파이트 범위 안에 들어가야 함
  - 46바이트 미만인 경우 패딩이라는 더미 데이터를 추가해 강제로 46바이트로 만듬
  - 1500바이트 이상인 경우엔 트랜스포트 계층이나 네트워크 계층에서 데이터를 쪼개어 이하로 맞춤

#### FCS

- Frame Check Sequence는 이더넷 프레임이 손상되지 않았는지 확인하기 위한 4바이트 필드
- 송신 측 단말은 이더넷 프레임을 송신할 때 송신 정보(MAC 주소, 페이로드 등)에 대해 일정한 계산(체크섬 계산)을 수행하고 그 결과를
FCS로 프레임 마지막에 추가함
- 수신 측 단말은 전달받은 이더넷 프레임에 동일한 계산을 적용하고 그 값이 FCS와 같다면 올바른 이더넷 프레임이라고 판단
  - 값이 다르면 손상되었다고 판단하고 파기함

### MAC 주소

- 이더넷 네트워크에 접속되어 있는 단말의 식별 ID
- 6바이트로 구성되며 1바이트씩 하이픈이나 콜론으로 구분해 12자리의 16진수로 표기함
- MAC 주소는 고유한 값이 아니기 때문에 이더넷 네트워크에 같은 MAC 주소의 단말이 여럿 존재하면 통신할 수 없음.
  - 중복되지 않는 MAC 주소로 수정해야 함

#### 통신 종류에 따른 MAC 주소의 차이

- 이더넷 네트워크에서의 통신은 유니캐스트, 브로드캐스트, 멀티캐스트 3가지

#### 유니캐스트

- 1:1 통신
- 송수신하는 각 단말의 MAC 주소가 송신지 MAC 주소와 수신지 MAC 주소가 됨
- 웹, 메일 등 인터넷 통신의 대부분은 유니캐스트

#### 브로드캐스트

- 1:N 통신
  - N은 같은 이더넷 네트워크에 접속되어 있는 자신 외의 모든 단말
- 이 브로드캐스트가 도달하는 범위를 브로드캐스트 도메인이라 부름
- 브로드캐스트는 ARP와 같은 네트워크상의 모든 단말에 알림/문의를 하는 프로토콜에 사용됨
- 브로드캐스트 시 수신지 MAC 주소는 6바이트 모두 '1' (ff:ff:ff:ff)라는 값을 사용

#### 멀티캐스트

- 1:N 통신
  - N은 특정 그룹(멀티캐스트 그룹)에 속하는 단말
- 어떤 단말이 멀티캐스트를 송신하면 그 그룹에 있는 단말들만 패킷을 수신
- 보르드캐스트는 그 네트워크에 있는 모든 단말이 강제로 패킷을 수신하지만 멀티캐스트는 애플리케이션을 기동한 단말만 패킷을 수신할 수 있기 때문에
트래픽 효율이 높아짐

### L2 스위치

- 데이터링크 계층에서 동작하는 네트워크 기기

#### L2 스위칭

- L2 스위치는 이더넷 헤더에 포함된 송신지 MAC 주소와 자신의 포트 번호를 MAC 주소 테이블이라는 메모리상의 테이블로 관리하며
이더넷 프레임의 전송 대상지를 바꾸어 통신 효율을 높임
  - 전송 대상지를 바꾸는 기능을 L2 스위칭이라 함
  - 가장 기본적 기능

#### VLAN

- VLAN은 1대의 L2 스위치를 여러 대의 L2 스위치로 가상 분할하는 기술
- 포트 기반 VLAN
  - 하나의 포트에 하나의 VLAN을 할당하는 기능
- 태그 VLAN
  - 이더넷 프레임에 VLAN 정보를 VLAN 태그로 붙이는 기능

#### PoE

- PoE(Power over Ethernet)는 트위스트 페어 케이블을 사용해 전원을 공급하는 기능
- 천장, 벽 안쪽 등 전원 케이블이 닿지 않는 장소에 설치하는 액세스 포인트나 네트워크 카메라에 트위스트 케이블 하나로 전원과 데이터를
동시에 공급할 수 있음

------------

## 무선 LAN(IEEE 802.11)

### IEEE802.11 프레임의 프레임 포맷

- 전송 속도나 변조 방식 등 무선과 관련한 많은 제어 정보가 포함되어 있음
- 유선 LAN과 함께 존재하기 위해 MAC 주소의 필드가 4개로 증가됨

#### 프리앰블

- IEEE802.11 프레임을 보냅니다 라는 합의를 의미하는 가변 길이 필드

#### 프레임 제어

- 프레임 제어에 필요한 정보를 포함한 2바이트 필드
- 프레임의 종류나 송신지/수신지의 종류, 프래그먼트 정보, 전력 상태 등
- 무선 LAN의 프레임의 종류
  - 데이터 프레임
    - IP 패킷을 송수신하기 위한 프레임
  - 관리 프레임
    - 어떤 액세스 포인트와 어떻게 접속할 것인지 관리하는 프레임
  - 제어 프레임
    - 데이터 프레임의 전송을 돕기 위해 존재하는 프레임
    - ACK 프레임 사용

#### Duration/ID

- 무선 회선을 점유할 예정 시간의 알림이나 단말의 배터리 소비량을 제어하는 전원 관리 식별자에 사용되는 2바이트 필드

#### MAC 주소 1/2/3/4

- 최대 4개의 MAC 주소 필드를 가질 수 있어 프레임 종류나 네트워크 구성에 따라 그 수와 용도가 달라짐
- 데이터 프레임의 MAC 주소
  - 네트워크 구성에 따라 달라짐
  - 인프라 모드
    - 무선 LAN 단말이 반드시 액세스 포인트를 경유해 통신하는 네트워크 구성
    - 무선 구간의 수신지 MAC주소 / 무선 구간의 송신지 MAC 주소 / 무선 LAN 단말의 송신지 MAC 주소나 수신지 MAC 주소 / NULL
  - 애드혹 모드
    - 액세스 포인트를 거치지 않고 무선 LAN 단말끼리 직접 통신하는 네트워크 구성
    - 무선 구간의 수신지 AMC 주소 / 무선 구간의 송신지 MAC 주소 / 사용자가 정의한 ID / NULL
  - WDS 모드
    - 액세스 포인트끼리 통신하는 네트워크 구성
      - 무선 LAN으로 네트워크를 연장할 때 등에 사용
    - 무선 구간의 수신지 MAC 주소 / 무선 구간의 송신지 MAC 주소 / 수신지 MAC 주소 / 송신지 MAC 주소
- 관리 프레임의 MAC 주소
  - 무선 LAN 단말과 액세스 포인트에서만 교환되는 프레임
  - 무선 구간에서의 수신지 MAC 주소 / 무선 구간