# 네트워크 계층

- 이더넷이나 무선 LAN에서 만들어진 네트워크를 함께 연결해 다른 네트워크에 있는 단말과의 연결성을 확보하는 계층
- 데이터링크 계층은 같은 네트워크 안에 존재하는 단말들의 연결까지만 담당
  - 해외에 있는 웹서버의 경우 다른 네트워크상에 존재하기 때문에 데이터링크 계층 수준에서는 연결할 수 없음

----------

## IPv4

- Internet Protocol version 4

### IPv4의 패킷 포맷

- IP에 의해 캡슐화되는 패킷을 IP 패킷
- 다양한 제어 정보를 설정하는 IP 헤더, 데이터 자체를 나타내는 IP 페이로드

#### 버전

- IP 버전을 나타내는 4비트 필드
- IPv4에서는 '4'(2진수로 0100)

#### 헤더 길이

- IPv4 헤더의 길이를 나타내는 4비트 필드
- Internet Header Length (IHL)이라고도 부름
- 헤더의 길이를 4바이트로 환산한 값이 들어감
- 기본적으로 20바이트이므로 5가 들어감(20바이트 = 160 비트 = 32 * 5)

#### ToS

- Type of Service는 IPv4 패킷의 우선도를 나타내는 1바이트 필드
- 우선 제어나 대역 제어, 혼잡 제어 등에서 사용함

#### 패킷 길이

- 헤더와 페이로드를 합친 패킷 전체의 길이를 나타내는 2바이트 필드

#### 식별자

- IP 프래그멘테이션 처리로 인해 식별자가 필요함
- 식별자, 플래크, 프래그먼트 오프셋에는 IP 프래그멘테이션에 관한 정보가 저장되어 있음
- 무작위로 할당되는 패킷 ID로 2바이트로 구성됨

#### 플래그

- 3비트로 구성되어 있으며 1번째 비트는 사용하지 않음

#### 프래그먼트 오프셋

- 패킷이 오리지널 패킷의 앞쪽부터 어느 위치에 있는지를 나타내는 13비트 필드

#### TTL

- Time To Live는 패킷의 수명을 나타내는 1바이트 필드
- IP 세계에서의 IP 패킷의 수명은 경유하는 라우터의 수(홉)
- 네트워크를 경유할 때마다 1씩 감소하며 0이되면 패킷이 파기됨
- 패킷을 파기한 라우터는 Time-to-live exceed라는 ICMPv4 패킷을 반환하고 파기한 패킷을 송신지 단말에 전달함

#### 프로토콜 번호

- IPv4 페이로드가 어떤 프로토콜로 구성되어 있는지를 나타내는 1바이트 필드

#### 헤더 체크섬

- 헤더의 정합성을 체크하기 위해 사용되는 2바이트 필드

#### 송신지/수신지 IPv4 주소

- 네트워크의 주소

#### 옵션

- IPv4 패킷 송신에 대한 확장 기능을 저장한 가변 길이 필드

#### 패딩

- 헤더의 비트 수를 정렬하기 위해 사용되는 필드

### IPv4 주소와 서브넷 마스크

- IPv4 주소는 그 자체로 사용하지 않고 서브넷 마스크라는 또 다른 32비트 값과 세트로 사용함
- IPv4 주소는 네트워크 부분과 호스트 부분이 있음
  - 네트워크 부분: 어떤 IPv4 네트워크에 있는가
  - 호스트 부분: 어떤 단말인가
- 서브넷 마스크는 이 2개를 구분하는 표시와 같은 것으로 '1'의 비트가 네트워크 부분, '0' 비트가 호스트 부분

#### 10진수 표기와 CIDR 표기

- 서브넷 마스크에는 10진수 표기와 CIDR 표기 2종류 표기 방법이 있음
- 10진수 표기
  - IPv4 주소와 같이 32비트를 8비트씩 4개 그룹으로 나눠 10진수로 변환하고 점으로 구분해서 표기
- CIDR 표기
  - IPv4 주소 뒤에 '/' 와 서브넷 마스크의 '1'의 비트 수를 표기

### 다양한 IPv4 주소

- 43억개 가량 있음
- 사용 용도, 사용 장소, 제외 주소 3가지로 분류

#### 사용 용도에 따른 분류

- 클래스 A에서 E까지 3개 주소 그룹으로 분류할 수 있음
- 일반적으로 사용하는 것은 A~C
- A,B,C 순서로 규모가 작아짐
- D,E는 특수한 용도로 사용하고 일반적으로 사용하지는 않음
- 