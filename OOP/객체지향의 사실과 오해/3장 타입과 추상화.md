# 타입과 추상화

- 지하철을 이용하는 승객의 목적은 하나의 역에서 다른 역으로 이동하는 것이다.
- 따라서 지하철 노선도 디자인에서 가장 중요한 것은 얼마나 사실적으로 지형을 묘사했느냐가 아니라
역과 역 사이의 연결성을 얼마나 직관적으로 표현했느냐다.
- 지하철 노선도는 역의 순서와 갈아타는 역의 표시를 제외하면 위치와 거리도 부정확했으며, 경로를 표시한 직선은 실제로 지하철이 이동하는 경로와는
상관이 없다.
- 이는 지도가 당연히 가져야 한다고 생각되는 정확성을 버리고 그 목적에 집중한 결과다.
- 이것은 지하철 노선도의 추상화다.

-----------------

## 추상화를 통한 복잡성 극복

- 지하철 노선도는 불필요한 지형 정보를 제거함으로써 단순함을 달성한 추상화의 훌륭한 예다.
  - 승객들이 지하철을 이용하는 이유와 지형 정보를 제거한 이유가 동일하다.
  - 역의 위치가 중요한 것이 아니라 역과 역 사이의 연결 관계가 중요했던 것
- 추상화란 현실에서 출발하되 불필요한 부분을 도려내가면서 사물의 놀라운 본질을 드러나게 하는 과정이라고 할 수 있다.
- 훌륭한 추상화는 목적에 부합해야 한다.
- 추상화의 정의
  - 어떤 양상, 세부 사항, 구조를 좀 더 명확하게 이해하기 위해 특정 절차나 물체를 의도적으로 생략하거나 감춤으로써 복잡도를 극복하는 방법
  - 복잡성을 다루기 위해 추상화는 두 차원에서 이루어짐
    - 구체적인 사물들 간의 공통점은 취하고 차이점은 버리는 일반화를 통해 단순하게 만듬
    - 중요한 부분을 강조하기 위해 불필요한 세부 사항을 제거함으로써 단순하게 만듬

-----------------

## 객체지향과 추상화

### 모두 트럼프일 뿐

- 앨리스와 하트 여왕이 최초로 마주치는 장면에서는 앨리스와 왕과 여왕, 정원사 등의 여러가지 객체들이 존재한다.
- 하지만 앨리스의 마지막 대사에서 알 수 있듯 이 객체들 대부분을 하나로 아울러 생각한다
  - 기껏해야 트럼프에 불과해
- 토끼를 제외한 모든 객체를 트럼프라는 하나의 개념으로 단순화해서 바라본다.

### 그룹으로 나누어 단순화하기

- 명확한 경계를 가지고 서로 구별할 수 있는 구체적인 사람이나 사물을 객체지향 패러다임에서는 객체라고 한다.
- 하지만 이야기속에서 나오는 다양한 인물들을 트럼프 라는 한 단어로 줄여 지칭할 수 있다.
- 그 이유는 인물들이 공통적으로 트럼프라고 했을 때 떠오르는 일반적인 외형과 행동 방식을 지니고 있기 때문이다.
- 트럼프와 토끼 라는 두 개의 렌즈를 통해 정원을 바라보는 것은 정원에 내재된 복잡성을 효과적으로 감소시킨다.

### 개념

- 앨리스가 인물들의 차이점을 무시하고 공통점만을 취해 트럼프라는 개념으로 단순화한 것은 추상화의 일종이다.
- 객체지향 패러다임의 중심에는 구체적이고 실제적인 객체가 존재하지만 수많은 객체들을 개별적인 단위로 취급하기에는 인지능력이 부족하다.
- 따라서 본능적으로 공통적인 특성을 기준으로 객체를 여러 그룹으로 묶어 동시에 다뤄야 하는 가짓수를 줄임으로써 상황을 단순화하려고 한다.
- 공통점을 기반으로 객체들을 묶기 위한 그릇을 개념(concept)라고 한다.
- 개념을 이용하면 객체를 여러 그룹으로 분류(classification)할 수 있다.
- 결국 각 객체는 특정한 개념을 표현하는 그룹의 일원으로 포함된다.
  - 하트 여왕은 트럼프라는 개념 그룹의 일원
  - 하얀 토끼는 토끼라는 개념 그룹의 일원
- 객체에 어떤 개념을 적용하는 것이 가능해서 개념 그룹의 일원이 될 때 객체를 그 개념의 인스턴스(instance)라고 한다.
- 객체란 특정한 개념을 적용할 수 있는 구체적인 사물을 의미한다. 개념이 객체에 적용됐을 때 객체를 개념의 인스턴스라고 한다.

### 개념의 세 가지 관점

- 심볼(symbol): 개념을 가리키는 간략한 이름이나 명칭
- 내연(intension): 개념의 완전한 정의를 나타내며 내연의 의미를 이용해 객체가 개념에 속하는지 여부를 확인할 수 있음
- 외연(extension): 개념에 속하는 모든 객체의 집합
- 엘리스가 정원사, 병사, 신하, 왕자와 공주, 하객으로 참석한 왕과 왕비들, 하트 잭, 하트 왕과 왕비의 몸이 납작하고 두 손과 두 발이
네모 귀퉁이에 달려 있기 때문에 트럼프라는 개념으로 묶었다.
  - 정원사, 병사 ~ 하트 왕과 왕비 : 개념에 속하는 모든 객체의 집합 (외연)
  - 몸이 납작하고 두 손과 두 발이 네모 귀퉁이에 달려있다: 개념의 완전한 정의 (내연)
  - 트럼프: 개념을 가리키는 이름 (심볼)
- 객체지향의 세계에서 가장 널리 알려진 유명인사가 클래스(class)라는 사실을 감안한다면 분류(classification)라는 개념이
얼마나 중요한지 실감할 수 있을 것이다.

### 객체를 분류하기 위한 틀

- 어떤 객체와 마주했을 때 객체에게 적용할 개념을 결정하는 것은 결국 해당 객체를 개념이 적용된 객체 집합의 일원으로 맞아들인다는 것을 의미한다.
- 따라서 분류란 특정한 객체를 특정한 개념의 객체 집합에 포함시키거나 포함시키지 않는 작업을 의미한다.
- 어떤 객체를 어떤 개념으로 분류할지가 객체지향의 품질을 결정한다.
- 객체를 안전하고 적절한 장소에 보관할 수 있도록 인지능력을 발휘해 직관적으로 분류하라.

### 분류는 추상화를 위한 도구다

- 개념을 통해 객체를 분류하는 과정은 추상화의 두 가지 차원을 모두 사용한다.
- 정원사, 병사, 신하 .. 를 트럼프라는 개념으로 묶은 것은 개별 객체 간의 차이점을 무시하고 공통점을 취한 결과
  - 추상화의 첫 번째 차원인 일반화를 적용한 결과
- 트럼프에 속하는 객체들의 공통점 중에서도 중요하다고 생각하는 특징은 몸이 납작하고 두 손과 두 발이 네모난 몸 모서리에 달려 있다
  - 추상화의 두 번째 차원인 불필요한 세부 사항을 제거
- 개념은 객체들의 복잡성을 극복하기 위한 추상화 도구다.

---------------

## 타입

### 타입은 개념이다

- 타입의 정의는 개념의 정의와 완전히 동일하다.
- 타입은 공통점을 기반으로 객체들을 묶기 위한 틀이다.
- 타입은 개념과 마찬가지로 심볼, 내연, 외연을 이용해 서술할 수 있으며 타입에 속하는 객체 역시 타입의 인스턴스라고 한다.

### 데이터 타입

- 실제로 메모리를 들여다 보면 그 안에는 끝없이 펼쳐진 0과 1의 행렬만이 존재한다.
- 메모리의 세상에는 타입이라는 질서가 존재하지 않는다.
- 컴퓨터 안에 살아가는 데이터를 목적에 따라 분류하기 시작하면서 프로그래밍 언어 안에는 서서히 타입 시스템(type system)이 자라나기 시작했다.
- 타입 시스템의 목적은 메모리 안의 모든 데이터가 비트열로 보임으로써 야기되는 혼란을 방지하는 것이다.
- 타입에 관련된 두 가지 중요한 사실
  - 타입은 데이터가 어떻게 사용되느냐에 관한 것
    - 숫자형 데이터가 숫자형인 이유는 연산을 할 수 있기 때문
    - 문자열형인 이유는 데이터를 연결해 새로운 문자열을 만들 수 있고 길이를 알 수 있기 때문
  - 타입에 속한 데이터를 메모리에 어떻게 표현하는지는 외부로부터 감춰진다.
    - 개발자는 해당 데이터 타입을 사용하기 위해 단지 데이터 타입에 적용할 수 있는 연산자만 알고 있으면 된다.
- 데이터 타입의 정의
  - 데이터 타입은 메모리 안에 저장된 데이터의 종류를 분류하는 데 사용하는 메모리 집합에 관한 메타데이터다.
  - 데이터에 대한 분류는 암시적으로 어떤 종류의 연산이 해당 데이터에 대해 수행될 수 있는지를 결정한다.

### 객체와 타입

- 객체지향 프로그램을 작성할 때 우리는 객체를 일종의 데이터처럼 사용한다.
- 객체를 타입에 따라 분류하고 그 타입에 이름을 붙이는 것은 결국 프로그램에서 사용할 새로운 데이터 타입을 선언하는 것과 같다.
- 하지만 객체는 데이터가 아니다.
- 객체에서 중요한 것은 객체의 행동이다. 상태는 행동의 결과로 초래된 부수효과를 쉽게 표현하기 위해 도입한 추상적인 개념일 뿐이다.
- 객체를 창조할 때 가장 중요하게 고려해야 하는 것은 객체가 이웃하는 객체와 협력하기 위해 어떤 행동을 해야 할지를 결정하는 것이다.

### 행동이 우선이다

- 객체가 어떤 행동을 하느냐에 따라 객체의 타입이 결정된다
- 객체의 타입은 객체의 내부 표현과는 아무런 상관이 없다.
- 객체의 내부 표현 방식이 다르더라도 어떤 객체들이 동일하게 행동한다면 그 객체들은 동일한 타입에 속한다.
  - 동일한 책임을 수행하는 일련의 객체는 동일한 타입에 속한다
- 동일한 타입에 속한 객체는 내부의 데이터 표현 방식이 다르더라도 동일한 메시지를 수신하고 이를 처리할 수 있다.
- 다만 내부 표현 방식이 다르기 때문에 동일한 메시지를 처리하는 방식은 서로 다를 수 밖에 없는데 이것은 다형성에 의미를 부여한다.
- 다형성이란 동일한 요청에 대해 서로 다른 방식으로 응답할 수 있는 능력을 뜻한다.
- 동일한 메시지를 서로 다른 방식으로 처리하기 위해서는 객체들은 동일한 메시지를 수신할 수 있어야 하기 때문에 결과적으로 다형적인 객체들은
동일한 타입(타입 계층)에 속하게 된다.
- 데이터의 내부 표현 방식과 무관하게 행동만이 고려 대상이라는 사실은 외부에 데이터를 감춰야 한다는 것을 의미한다.
- 따라서 훌륭한 객체지향 설계는 외부에 행동만을 제공하고 데이터는 행동 뒤로 감춰야 한다.
  - 이 원칙을 캡슐화라고 한다.
- 행동에 따라 객체를 분류하기 위해서는 객체가 내부적으로 관리해야 하는 데이터가 아니라 객체가 외부에 제공해야 하는 행동을 먼저 생각해야 한다.
- 데이터를 먼저 결정하고 객체의 책임을 결정하는 방법은 유연하지 못한 설계라는 악몽을 초래한다.
- 객체를 결정하는 것은 행동이다

-----------------

## 타입의 계층

### 트럼프 계층

- 앨리스 이야기에 나오는 정원사 ... 왕과 여왕은 정말로 트럼프인가?
- 트럼프와 몇 가지 특징을 공유하기 때문에 트럼프라 불렀지 진짜로 트럼프는 아니다.
- 객체가 동일한 타입으로 분류되기 위해서는 공통의 행동을 가져야만 한다.
- 트럼프는 납작 엎드릴 수 있고 뒤집어질 수는 있지만 걸어다닐 수는 없다.
- 하지만 이야기속 등장인물들은 납작 엎드릴 수 있고 뒤집어질 수 있으며 걸어다닐 수 있다.
- 트럼프 인간 타입의 객체는 트럼프 타입의 객체가 할 수 있는 모든 행동을 할 수 있을뿐만 아니라 추가적인 행동을 더 할 수 있다.
- 외연이라는 객체 집합의 관점에서 트럼프 인간은 트럼프이기 때문에 트럼프 인간 타입에 속한 객체는 트럼프 타입의 객체에도 속해야 한다.
- 트럼프 인간은 트럼프보다 좀 더 특화된 행동을 하는 특수한 개념이다.
  - 이 두 개념 사이의 관계를 일반화/특수화(generalization/specialization) 관계라고 한다.

### 일반화/특수화 관계

- 일반화와 특수화는 동시에 일어난다.
- 특수하다는 것은 일반적인 개념보다 범위가 더 좁다는 것을 의미한다.
- 중요한 것은 객체지향에서 일반화/특수화 관계를 결정하는 것은 객체의 상태를 표현하는 데이터가 아니라 행동이라는 것이다.
- 두 타입 간에 일반화/특수화 관계가 성립하려면 한 타입이 다른 타입보다 더 특수하게 행동해야 하고 반대로 한 타입은 다른 타입보다
더 일반적으로 행동해야 한다.
- 행동의 관점에서 일반적인 타입이란 특수한 타입이 가진 모든 행동들 중에서 일부 행동만을 가지는 타입을 가리킨다.
- 특수한 타입은 일반적인 타입이 할 수 있는 모든 행동을 동일하게 수행할 수 있어야 한다.

### 슈퍼타입과 서브타입

- 좀 더 일반적인 타입을 슈퍼타입(Supertype), 좀 더 특수한 타입을 서브타입(Subtype)이라고 한다.
- 어떤 타입이 다른 타입의 서브타입이 되기 위해서는 행위적 호환성을 만족시켜야 한다.
- 서브타입은 슈퍼타입을 대체할 수 있어야 한다.(LSP)

### 일반화는 추상화를 위한 도구다

- 일반화/특수화 계층은 객체지향 패러다임에서 추상화의 두 번째 차원을 적절하게 활용하는 대표적인 예다.
- 객체지향 패러다임을 통해 세상을 바라보는 거의 대부분의 경우에 분류와 일반화/특수화 기법을 동시에 적용하게 된다.

--------------

## 정적 모델

### 타입의 목적

- 타입을 사용하는 이유는 인간의 인지 능력으로는 시간에 따라 동적으로 변하는 객체의 복잡성을 극복하기가 너무 어렵기 때문이다.
  - 앨리스는 음식을 먹을때 마다 키가 변하지만 모든 경우에 앨리스는 단지 앨리스일 뿐이다.
- 앨리스라고 하는 객체의 상태는 변하지만 앨리스를 다른 객체와 구별할 수 있는 식별성은 동일하게 유지된다.
- 따라서 우리는 머리속에 앨리스가 가질 수 있는 모든 경우의 키 값을 나열하는 대신, 앨리스의 키가 임의의 값을 가질 수 있다는 사실만을 생각함으로써
상황을 단순하게 만들 수 있다.
- 타입은 시간에 따라 동적으로 변하는 앨리스의 상태를 시간과 무관한 정적인 모습으로 다룰 수 있게 해준다.

### 그래서 결국 타입은 추상화다

- 어떤 시점에 앨리스에 관해 생각할 때 불필요한 시간이라는 요소와 상태 변화라는 요소를 제거하고 철저하게 정적인 관점에서 앨리스의 모습을
묘사하는 것을 가능하게 해주는 타입은 추상화다.
- 타입을 이요하면 객체의 동적인 특성을 추상화할 수 있다.
- 타입은 시간에 따른 객체의 상태 변경이라는 복잡성을 단순화할 수 있는 효과적인 방법이다.

### 동적 모델과 정적 모델

- 객체를 생각할 때 우리는 두 가지 모델을 동시에 고려한다.
  - 객체가 특정 시점에 구체적으로 어떤 상태를 가지느냐
    - 객체의 스냅샷이라고 한다.
    - 객체지향 모델링을 위한 표준 언어인 UML에서 스냅샷은 객체 다이어그램이라고 불린다.
    - 스냅샷처럼 실제로 객체가 살아 움직이는 동안 상태가 어떻게 변하고 어떻게 행동하는지를 포착하는 것을 동적 모델(dynamic model)이라고 한다.
  - 객체가 가질 수 있는 모든 상태와 모든 행동을 시간에 독립적으로 표현하는 것
    - 타입 모델(type diagram)이라고 한다.
    - 동적으로 변하는 객체의 상태가 아니라 객체가 속한 타입의 정적인 모습을 표현하기 때문에 정적 모델(static model)이라고 한다.
- 객체지향 애플리케이션을 설계하고 구현하기 위해서는 객체 관점의 동적 모델과 객체를 추상화한 타입 관점의 정적 모델을 적절히 혼용해야 한다.
- 객체지향 프로그래밍 언어를 이용해 클래스를 작성하는 시점에는 시스템을 정적인 관점에서 접근하는 것이고, 애플리케이션을 실행해 객체의 상태 변경을
추적하고 디버깅하는 동안에는 객체의 동적인 모델을 탐험하고 있는 것이다.

### 클래스

- 객체지향 프로그래밍 언어에서 정적인 모델은 클래스를 이용해 구현된다.
- 타입을 구현하는 가장 보편적인 방법은 클래스를 이용하는 것이다.
- 타입은 객체를 분류하기 위해 사용하는 개념이고, 클래스는 단지 타입을 구현할 수 있는 여러 구현 매커니즘 중 하나이기 때문에
타입과 클래스는 동일한 것이 아니다.
- 클래스와 타입을 구분하는 것은 설계를 유연하게 유지하기 위한 바탕이 된다.
- 클래스는 타입의 구현 외에도 코드를 재사용하는 용도로도 사용되기 때문에 클래스와 타입을 동일시하는 것은 수많은 오해와 혼란을
불러일으키곤 한다.