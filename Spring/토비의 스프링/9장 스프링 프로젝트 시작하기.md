# 스프링 프로젝트 시작하기

- 스프링은 어떤 종류의 애플리케이션에도 잘 들어맞도록 매우 유연하게 설계된 범용 프레임워크
  - 아키텍처의 종류나 프로젝트를 구성하는 방법에 자유도가 높음
- 스프링이 유연하다고 해서 아무렇게나 가져다 쓰면 스프링이 주는 유익을 제대로 얻지 못할 수 있음

---------

## 자바 엔터프라이즈 플랫폼과 스프링 애플리케이션

- 스프링으로 만들 수 있는 애플리케이션의 종류에는 제한이 없음
  - 자바 언어를 사용하는 모든 종류의 프로젝트라면 어디든 사용 가능
  - 웹, 스윙, 이클립스 RCP로 만드는 독립형 프로그램에도 적용 가능
  - 애플릿, 모바일 애플리케이션도 가능
- 하지만 스프링은 주로 자바 엔터프라이즈 환경에서 동작하는 애플리케이션을 개발하는 목적으로 사용됨

### 클라이언트와 백엔드 시스템

- 가장 많이 사용된느 구조는 클라이언트가 웹 브라우저이고 백엔드 시스템이 DB인 구성
  - DB를 사용하는 웹 애플리케이션

### 애플리케이션 서버

- 스프링으로 만든 애플리케이션을 자바 서버환경에 배포하려면 JavaEE(J2EE) 서버가 필요로함

#### 경량급 WAS/서블릿 컨테이너

- 스프링은 기본적으로 톰캣이나 제티 같은 가벼운 서블릿 컨테이너만 있어도 충분
  - EJB나 리소스 커넥터, WAS가 제공하는 분산 서비스 등이 굳이 필요하지 않음

#### WAS

- 미션 크리티컬한 시스템에서 요구하는 고도의 안정성이나 고성능 시스템에서 필수적인 안정적인 리소스 관리,
레거시 시스템의 연동이나 기존 EJB로 개발된 모듈을 함께 사용하는 등의 필요가 있다면 상용 또는 오픈소스 WAS를 이용할 수 있음

### 스프링 애플리케이션의 배포 단위

- 세 가지 단위로 배포 가능함

#### 독립 웹 모듈

- war로 패키징된 독립 웹 모듈
- 톰캣 같은 서블릿 컨테이너를 쓴다면 독립 웹 모듈이 유일한 방법

#### 엔터프라이즈 애플리케이션

- 확장자가 ear

#### 백그라운드 서비스 모듈

- rar 패키징
- 스프링으로 만든 애플리케이션이 UI를 가질 필요는 없고 서버 내에서 백그라운드 서비스처럼 동작할 필요가 있다면 rar 모듈
- WAS가 반드시 필요함

---------------

## 애플리케이션 아키텍처

- 클라이언트와 백엔드 시스템의 종류와 사용 기술, 연동 방법을 결정했다면 시스템 레벨의 아키텍처는 대략 구성된 셈
  - 스프링 웹 애플리케이션의 아키텍처를 결정해야 함
- 아키텍처는 여러 가지 방식으로 정의되고 이해될 수 있는 용어
  - 가장 단순한 정의를 보자면 어떤 경계 안에 있는 내부 구성요소들이 어떤 책임을 갖고 있고, 어떤 방식으로 서로 관계를 맺고 동작하는지를 규정하는 것
- 아키텍처는 단순히 정적인 구조를 나타내는 것으로만 생각하기 쉽지만 실제로는 그 구조에서 일어나는 동적인 행위와 깊은 관계가 있음

### 계층형 아키텍처

- 관심, 책임, 성격, 변하는 이유와 방식이 서로 다른 것들을 분리함으로써 분리된 각 요소의 응집도는 높이고 결합도는 낮추는 것

#### 아키텍처와 SoC

- 오브젝트 레벨에서 분리의 문제에 대해 생각
  - 두 개의 오브젝트로 분리
  - 유연한 결합을 가질 수 있도록 인터페이스를 두고 DI
- 아키텍처 레벨에서 좀 더 큰 단위에 대해서도 동일하게 적용 가능함
- 성격이 다른 것은 아키텍처 레벨에서 분리해주는 게 좋음
  - 분리된 각 오브젝트는 독자적으로 개발과 테스트가 가능해 개발과 변경 작업이 모두 빨라질 수 있음
- 책임과 성격이 다른 것을 크게 그룹으로 만들어 분리해두는 것을 아키텍처 차원에서는 계층형 아키텍처라고 부름
  - 계층이라는 의미를 가진 영어 단어인 티어를 써서 멀티 티어 아키텍처라고도 함
  - 웹 기반 엔터프라이즈 애플리케이션은 일반적으로 세 개의 계층을 갖는다고 해 3계층 애플리케이션이라고 함

#### 3계층 아키텍처와 수직 계층

- 백엔드의 DB나 레거시 시스템과 연동하는 인터페이스 역할을 하는 데이터 엑세스 계층, 비즈니스 로직을 담고 이쓴ㄴ 서비스 계층, 웹 기반의
UI를 만들어내고 흐름을 관리하는 프레젠테이션 계층으로 구분
- 이름이 다양함
- 프레젠테이션 계층
  - 웹 계층
  - UI 계층
  - MVC 계층
- 서비스 계층
  - 매니저 계층
  - 비즈니스 로직 계층
- 데이터 엑세스 계층
  - DAO 계층
  - EIS 계층

#### 데이터 엑세스 계층

- DAO 계층이라고도 불림
  - DAO 패턴을 보편적으로 사용하기 때문
- DB 외에도 ERP, 레거시 시스템, 메인 프레임 등에 접근하는 역할을 하기 때문에 EIS(Enterprise Information System) 계층이라고도 함

#### 서비스 계층

- 잘 만들어진 스프링 애플리케이션의 서비스 계층 클래스는 이상적인 POJO로 작성됨
- 객체지향적인 설계 기법이 적용된 코드를 통해 비즈늬스 로직의 핵심을 잘 담아내고 이를 쉽게 테스트하고 유연하게 확장할 수 있음
- 서비스 계층은 특별한 경우가 아니라면 추상화 수직 계층구조를 가질 필요가 없음
  - 추상화 수직 계층 구조란 계층 안에서 추상화를 통해 수직으로 만든것
    - DAO 계층에 SimpleJdbcLayer, JdbcTemplate, 등등

#### 프레젠테이션 계층

- 매우 다양한 기술과 프레임워크의 조합을 가질 수 있음
  - HTTP 프로토콜
  - HTML, 자바스크립트
  - 등등

#### 계층형 아키텍처 설계의 원칙

- 각 계층은 응집도가 높으면서 다른 계층과는 낮은 결합도를 유지할 수 있어야 함
- 각 계층은 자신의 계층의 책임에만 충실해야 함

```java
public ResultSet findUsersByName(String name) throws SQLException;
```

- 위 DAO 인터페이스는 데이터 액세스 계층의 인터페이스다
- 서비스는 해당 인터페이스를 사용해야 하는데 예외처리와 ResultSet이라는 데이터 액세스 기술에 얽매인다

```java
public List<User> findUsersByName(String name)
```

- 으로 바꿔야 한다
- 프레젠테이션 계층의 오브젝트를 그대로 서비스 계층에 전달해서도 안된다
  - HttpServletRequest나 HttpServletResponse, HttpSession 등
- 계층의 경계를 넘어갈 때는 반드시 특정 계층에 종속되지 않는 오브젝트 형태로 변환해줘야 함
- 