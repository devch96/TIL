# 클라우드 네이티브 소개

- 클라우드 네이티브 애플리케이션은 클라우드에서 실행되면서 변화에 탄력적으로 대응하고 고도로 분산되어 있는 시스템
- 시스템은 여러 개의 서비스로 구성되며 이 서비스들은 네트워크를 통해 서로 통신
- 시스템은 끊임없이 변하는 동적 환경에 배포

---------

## 클라우드 네이티브란 무엇인가?

- 클라우드 네이티브 애플리케이션이 클라우드를 위해 특별히 설계되어야 하고 클라우드 환경과 클라우드 컴퓨팅 모델의 장점을
활용할 수 있는 특성이 있어야 함
- 클라우드가 아닌 환경에서 실행되도록 설계된 기존 애플리케이션을 클라우드로 옮기는 것을 리프트 및 시프트(lift and shift)접근 방식이라고
부르는데 이렇게 한다고 애플리케이션이 클라우드 네이티브가 되는 것은 아님

### 클라우드 네이티브에서의 세 가지 P

- 기업체와 같은 조직에서 클라우드 네이티브 기술을 사용하면 공용, 사설 및 하이브리드 클라우드와 같은 현대적이고 동적인 환경에서 확장 가능한
애플리케이션을 구축하고 실행할 수 있음
  - 접근 방식의 예로는 컨테이너, 서비스 메시, 마이크로서비스, 불가변 인프라, 선언적 API 등
- 느슨하게 결합된 시스템에서 이러한 기술을 사용하면 복원력이 뛰어나고 관리가 용이하면 관찰 가능한 시스템을 만들 수 있다. 이것이
자동화와 결합되면 엔지니어들은 최소의 노력만으로도 큰 영향을 끼치는 변경을 자주 그리고 예측 가능한 방식으로 할 수 있다.
- 플랫폼(platform): 클라우드 네이티브 애플리케이션은 클라우드 같은 동적 분산 환경을 기반으로 하는 플랫폼에서 실행됨
- 속성(property): 클라우드 네이티브 애플리케이션은 확장 가능하고 느슨하게 결합되며 복원력이 뛰어나고 관리가 용이하며 관찰 가능하도록 설계됨
- 실행(practice): 견고한 자동화를 통해 빈번하고 예측 가능한 방식으로 시스템을 변경하는 것이 포함됨(자동화, 지속적 전달, 데브옵스 등)

---------

## 클라우드와 클라우드 컴퓨팅 모델

- 클라우드 네이티브 애플리케이션이 클라우드 환경에서 잘 작동하도록 설계하려면 환경에 대해 알아야 함
- 클라우드는 클라우드 컴퓨팅 모델에 따라 컴퓨팅 자원을 소비자에게 제공하는 IT 인프라
- 클라우드 컴퓨팅은 설정 가능한 컴퓨팅 자원(네트워크, 서버, 스토리지, 애플리케이션 및 서비스 등)의 공유 풀에 접근할 수 있도록 해주는
모델인데, 여기서 접근은 어디서나 편리하게 주문형으로 네트워크를 통해 이루어지며, 관리에 들어가는 노력이나 서비스 제공자와의 접촉을
최소로 하면서 이런 서비스를 신속하게 제공하거나 회수할 수 있다.
  - 이 모델에서 탄력성은 주요 특징 가운데 하나(컴퓨팅 자원은 필요에 따라 동적으로 더 많이 제공하거나 회수할 수 있음)
- 클라우드 서비스를 제공하기 위한 몇 가지 배포 모델이 존재하는데 주요한 것으로는 사설 클라우드, 공공 클라우드, 하이브리드 클라우드가 있음
  - 사설 플라우드
    - 한 단체나 조직에서만 사용하도록 제공하는 클라우드 인프라
  - 공공 클라우드
    - 일반 사용자들에게 공공으로 제공되는 클라우드 인프라
    - AWS
  - 하이브리드 클라우드
    - 앞의 두 가지 유형에 해당하는 클라우드 인프라 구성 몇 개를 하나로 묶어 마치 하나의 단일 환경인 것처럼 서비스를 제공
- 클라우드 컴퓨팅 모델이 제공하는 서비스 모델은 소비자에게 제공되는 기능에 따라 다섯 가지로 나뉨

### 서비스형 인프라스트럭처

- 서비스형 인프라스트럭처(infrastructure as a service, IaaS) 모델에서 사용자는 서버, 스토리지 및 네트워크와 같은 자원을 직접 제어하고 제공할 수 있음
  - AWS

### 서비스형 컨테이너

- 서비스형 컨테이너(container as a service, CaaS) 모델에서 사용자는 가상화를 위한 기본 리소스를 제어할 수 없고 대신 컨테이너를 만들고 관리
- 클라우드 공급자는 이러한 컨테이너의 요구를 충족하기 위해 기본 리소스를 제공하는데 예를 들어 새로운 가상 머신을 만들고 인터넷을 통해 액세스할 수 있도록
네트워크를 구성해줌
  - 도커 스웜, 아파치 메소스, 쿠버네티스
- 주요 클라우드 공급자는 모두 CaaS의 실제적 표준이 된 쿠버네티스를 관리형 서비스로 제공함
  - 아마존 일래스틱 쿠버네티스 서비스, 애저 쿠버네티스 서비스

### 서비스형 플랫폼

- 서비스형 플랫폼(platform as a service, PaaS) 모델에서는 클라우드 공급자가 인프라, 도구, API를 제공하고 개발자는 이를 사용해 애플리케이션을
빌드하고 배포함
  - 개발자는 자바 애플리케이션을 빌드하고 JAR로 패키징한 다음 PaaS 모델로 실행되고 있는 플랫폼에 배포할 수 있음
  - 플랫폼은 자바 런타임, 기타 필수 미들웨어를 제공하며 데이터베이스 또는 메시징 시스템과 같은 추가 서비스도 제공할 수 있음

### 서비스형 함수

- 서비스형 함수(function as a service, FaaS) 모델의 서버리스 컴퓨팅을 사용하면 사용자는 함수의 형태로 자신의 애플리케이션의 비즈니스 로직을 구현하는 데만
집중할 수 있고 플랫폼은 서버 및 나머지 인프라를 제공함
  - AWS 람다, 애저 함수

### 서비스형 소프트웨서

- 서비스형 소프트웨어(software as a service, SaaS)는 가장 추상화된 서비스
- 소비자는 사용자로서 애플리케이션에 액세스하고 클라우드 공급자는 소프트웨어 및 인프라 스택 전체를 관리함
- 많은 회사가 애플리케이션을 만들고 CaaS 또는 PaaS 모델을 통해 실행한 다음에 최종 고객에게 SaaS 형태로 판매함
- 일반적으로 웹 브라우저 또는 모바일 장치와 같은 경량 클라이언트 프로그램을 통해 사용
  - 오피스365

-------

## 클라우드 네이티브 애플리케이션의 특성

- 클라우드는 어디(where)에 관한 것이고 클라우드 네이티브는 어떻게(how)에 관한 것

### 확장성

- 클라우드 네이티브 애플리케이션은 확장이 가능하도록 설계됨
- 추가 리소스(특성에 따라 수직적 확장과 수평적 확장으로 나눔)를 제공해 증가하는 워크로드를 지원한다는 것
- 수직적 확장
  - CPU나 메모리와 같은 컴퓨팅 노드에 하드웨어 리소스를 추가하거나 제거하는 것을 의미
  - 하드웨어 리소스를 무한정 추가할 수는 없기 때문에 제한적으로 이루어짐
  - 이 접근 방식에서는 애플리케이션 자체를 확장 혹은 축소하도록 명시적으로 설계할 필요는 없음
- 수평적 확장
  - 시스템에 더 많은 컴퓨팅 노드나 컨테이너를 추가하는 것을 의미
  - 제한은 없지만 애플리케이션 자체가 확장 가능하도록 만들어야 함
- 모든 것이 역동적이고 끊임없이 변화하는 클라우드에서는 수평적 확장을 선호

### 느슨한 결합

- 각 컴포넌트들이 가능한 한 다른 컴포넌트에 대한 지식을 거의 가지고 있지 않은 시스템이 본질적으로 가지고 있는 속성이 느슨한 결합
- 각 컴포넌트는 독립적으로 진화해나가고 그 결과 한 컴포넌트가 바뀐다고 해서 다른 부분까지 변경할 필요가 없도록 하는 것

### 복원력

- 결함이나 환경 변화가 있는 경우에도 서비스를 제공한다면 복원력을 가지고 있다고 말할 수 있음
- 복원력은 정상 작동에 대한 오류 및 문제에 직면하여 허용 가능한 수준의 서비스를 제공하고 유지할 수 있도록 하는 하드웨어 소프트웨어 네트워크의 기능
- 클라우드 네이티브 시스템과 같이 고도로 분산된 시스템의 경우에 변화는 예외적으로 발생하는 상황으로 간주하기보다는 일어날 수밖에 없는
법칙처럼 생각해야 함
- 결함(fault)
  - 결함은 소프트웨어 또는 인프라에서 잘못된 내부 상태를 생성하는 고장
  - 메서드 호출 시 널이 아닌 값을 반환해야 하는 경우에도 널 값을 반환하는 경우
- 오류(error)
  - 오류는 시스템에 대해 예상하는 작동과 시스템이 실제 보이는 작동 간의 불일치
  - NullPointerException이 발생하는 경우
- 실패(failure)
  - 결함이 촉발되어 오류가 발새하면 실패로 이어져 시스템이 응답하지 않거나 요구 사양에 따라 작동하지 못하게 될 수 있음
  - NullPointerException이 적절하게 처리되지 못하면 이 오류는 실패를 유발하고 시스템은 모든 요청에 대해 500 코드로 응답하게 됨

### 관측 가능성

- 어떤 한 시스템을 고려한다면, 관측 가능성은 그 시스템의 외부 출력에서 내부 상태를 얼마나 잘 추론할 수 있는지를 측정하는 것
- 외부 출력은 측정값, 로그, 트레이스와 같은 데이터가 될 수 있음
- 관측 가능성의 네 가지 요소
- 모니터링(monitoring)
  - 애플리케이션의 전반적인 상태에 대한 정보를 얻고 실패를 식별하기 위해 애플리케이션의 특정 양상을 측정하는 것
  - 스프링 부트 액추에이터, 프로메테우스
- 경고/시각화(alerting/visualization)
  - 시스템 상태에 대한 데이터 수집은 수집된 데이터로 무언가 조치를 취하는 것으로 이어져야 유용함
  - 그라파나
- 분산 시스템 추적 인프라(distributed systems tracing infrastructure)
  - 분산 시스템에서는 모든 서브 시스템 내의 작동을 추적하는 것만으로는 충분하지 않음
  - 서로 다른 서브시스템 사이에서 흐르는 데이터를 추적하는 것 역시 필수적
  - 그라파나 템포
- 로그 집계/분석(log aggregation/analytics)
  - 클라우드 네이티브 시스템에서는 로그를 집계하고 수집하여 시스템 작동에 대한 더 나은 데이터를 제공하고, 해당 데이터에서
  정보를 찾아내기 위해 분석을 수행할 수 있어야 함
  - 플루언트 비트, 로키, 그라파나

### 관리 용이성

- 외부 입력을 통해 유한한 시간 이내에 시스템의 상태 또는 출력을 변경하는 능력
- 관리 용이성은 코드를 바꾸지 않고도 애플리케이션의 작동을 수정할 수 있는 능력
  - 유지 보수성과 혼동하면 안됨

---------

## 클라우드 네이티브를 지원하는 문화 및 관행

### 자동화

- 자동화(automation)는 클라우드 네이티브의 핵심
- 반복적인 수동 작업을 자동화
- 프로세스와 작업이 반복 가능하며 시스템이 전반적으로 한층 더 안정적이고 신뢰할 수 있게 됨
- 클라우드 자동화의 두 가지 중요한 범주는 인프라 제공 및 설정 관리인데, 코드형 인프라스트럭처와 코드형 설정이라고 부름
- 모든 인프라 생성 및 설정 관리 작업을 자동화하면 불안정하고 신뢰성이 떨어지는 서버(스토플레이크 서버)를 생성하는 것을 피할 수 있음

### 지속적 전달

- 프로덕션 환경에 언제든지 배포할 수 잇는 방식으로 소프트웨어를 구축하는 소프트웨어 개발의 한 분야
- 지속적 통합(continuous integration, CI)은 지속적 전달의 토대가 되는 관행
- 커밋이 있으면 소스는 자동으로 컴파일되고 테스트되며 실행 가능한 아티팩트(JAR)로 패키징됨
- 지속적 전달(continuous delivery, CD)은 CI를 기반으로 하며 기본 브랜치가 문제없이 배포 가능한 상태를 유지하도록 하는 데 중점을 둠
- 배포 유효성을 검증하기 위해 사용자 수락 테스트, 성능 테스트, 보안 테스트, 컴플라이언스 테스트와 같은 여러 테스트를 거침
- 지속적 전달은 배포 파이프라인을 통해 전체 프로세스의 자동화를 촉진함
- 지속적 전달을 지속적 배포(continuous deployment)와 혼동하는 경우가 있음
  - 지속적 전달은 변경이 이루어진 후에 소프트웨어가 실제 서비스 환경에 배포될 수 있는 상태인지 확인을 필요로 함
  - 배포 여부는 사업상의 결정
  - 지속적 배포는 배포 파이프라인에 마지막 단계를 하나 추가하여 프로덕션에 자동으로 배포함

### 데브옵스

- 데브옵스는 지위나 배경에 관계없는 사람들이 시스템을 구상, 개발, 배포 및 운영하기 위해 함께 협력하는 문화
- 공통의 목표를 향해 함께 일하는 것

--------

## 클라우드가 최선의 선택인가?

- 클라우드 네이티브를 통해 해결하려는 문제점을 가지고 있지 않고 그러한 속성이 필요 없다면 클라우드 네이티브는 최적의 방안이 아닐 수 있음
- 클라우드 네이티브로 가기 위한 주요 목표는 속도, 확장성, 복원력 및 비용

### 속도

- 소프트웨어를 더 신속하게 출시하는 것
- 자동화된 작업, 지속적 전달 워크플로 및 데브옵스 관행과 결합된 클라우드 네이티브 접근 방식을 통해 기업은 일을 더 빨리 진행할 수 있고
출시 시간을 단축할 수 있음

### 복원력

- 복원력이 좋은 시스템은 잘못된 일이 발생하더라도 서비스를 계속 제공함
- 클라우드 기술을 통해 복원력이 높은 인프라를 구현하기 위한 전략을 세울 수 있음

### 확장성

- 새로운 고객에게 신속하고 효율적으로 적응해야 하거나 새로운 유형의 클라이언트를 지우너할 수 있는 유연성이 필요한 비즈니스라면
확장성 높은 클라우드 네이티브 애플리케이션을 클라우드와 결합해 사용하여 탄력성을 확보할 수 있음

### 비용

- 클라우드 컴퓨팅 모델은 탄력성과 온디멘드 사용당 지불 정책으로 IT 인프라 비용을 최적화하는 데 도움이 됨

-------

## 클라우드 네이티브 구성

### 컨테이너

- 애플리케이션은 특정한 환경에서 실행되도록 작성되었기 때문에 모든 환경을 가능한 한 비슷하게 유지하는 것이 중요
- 컨테이너 이전에는 환경 재구축, 격리 및 설정을 위해 가상 컴퓨터에 의존함
- 가상화는 하드웨어를 추상화하는 하이퍼바이저 구성 요소를 활용해 동작하기 때문에 동일한 시스템에서 여러 운영체제를 독립적으로 실행할 수 있음
- OS 컨테이너는 내부에서 애플리케이션을 실행하기 위해 필요한 모든 것을 가지고 있는 경량 실행 파일 패키지로 호스트와 커널을 공유함
- 전통적인 방식으로 애플리케이션을 실행하려면 가상 컴퓨터에 자바 런타임 환경과 미들웨어를 설치하고 유지 관리해야 하나 컨테이너는 애플리케이션이나 의존 라이브러리 혹은
미들웨어와 관계 없이 거의 모든 컴퓨팅 환경에서 안정적으로 실행할 수 있음
- 컨테이너는 민첩성, 다양한 환경에서의 이식성 및 배포 반복성이 뛰어남

### 오케스트레이션

- 단일 서버에서 컨테이너를 생성하고 관리하는 것은 간단하나 수십 또는 수백 개의 컨테이너를 여러 대의 서버에 배포하고 처리하려면 또 다른 무언가가 필요
- 쿠버네티스를 기반으로 하는 CaaS 플랫폼은 여러 서버에서 실행되는 컨테이너들을 조정(orchestrating)하면서 클라우드 네이티브 환경에서 발생하는 모든 중요한 무넺를
해결하기 위해 많은 기능을 제공함
- 컨테이너 오케스트레이션은 다음과 같은 다양한 작업을 자동화하는 데 도움이 됨
  - 클러스터 관리로서 필요한 경우 머신을 생성, 삭제할 수 있음
  - 클러스터 내 컨테이너를 CPU 및 메모리에 대한 컨테이너 요구 사항을 충족하는 머신에 스케줄링 및 배포함
  - 높은 가용성과 복원력을 위해 컨테이너를 동적으로 확장하고 상태 모니터링을 활용함
  - 컨테이너가 서로 통신하도록 네트워클르 설정하고 라우팅, 서비스 검색 및 로드 밸런싱을 정의함
  - 인터넷에 서비스 노출, 포트 및 네트워크를 구축함
  - 특정 기준에 따라 컨테이너에 자원을 할당함
  - 컨테이너 내에서 실행되는 애플리케이션을 설정함
  - 보안 및 액세스 제어 정책을 시행함
- 컨테이너 오케스트레이터의 예로는 쿠버네티스, 도커 스웜, 아파치 메소스가 있음

### 서버리스

- 서버리스 컴퓨팅 모델에 따라 개발자는 애플리케이션에 대한 비즈니스 로직을 구현하는 데만 집중할 수 있음
- 서비스형 백엔드(backend as a service: BaaS)
  - 클라우드 공급자가 제공하는 타사 서비스에 크게 의존하는 애플리케이션
    - 타사 서비스로는 데이터베이스, 인증 서비스, 메시지 큐와 같은 것
  - 개발자는 백엔드 기능의 대부분 또는 전부를 BaaS 공급 업체에 일임하고 프런트엔드 애플리케이션을 구현
  - 옥타를 사용해 인증하거나 파이어베이스를 사용해 데이터를 저장하거나
- 서비스형 함수(function as a service: FaaS)
  - 상태가 없고 이벤트에 의해 실행되며 플랫폼이 전적으로 관리하는 애플리케이션
- 서버리스 애플리케이션은 일반적으로 이벤트 기반이며 HTTP 요청이나 메시지와 같이 처리할 이벤트가 있을 때만 실행됨

---------

## 클라우드 네이티브 애플리케이션을 위한 아키텍처

### 다중 계층에서 마이크로서비스 아키텍처까지 그리고 그 이후

- 각 아키텍처 스타일에는 용례가 있음. 만병 통치약이나 일륜적인 해결책 같은 것은 없음
- 클라우드 네이티브 애플리케이션에서 마이크로서비스 스타일을 사용할 수 있다는 점은 분명

### 클라우드 네이티브 애플리케이션을 위한 서비스 기반 아키텍처

- 서비스와 상호작용이라는 두 가지 요소로 나뉨
  - 서비스(service): 다른 구성 요소에 어떤 종류의 서비스를 제공하는 구성 요소
  - 상호작용(interaction): 시스템의 요구 사항을 충족시키기 위해 수행되는 서비스 간 통신
- 애플리케이션 서비스
  - 상태를 갖지 않으며 모든 종류의 논리를 구현
  - 느슨한 결합과 높은 응집력을 염두에 두고 각 서비스를 설계하는 것이 가장 중요
  - 대부분의 서비스를 스스로 개발하고 유지하고 있겠지만 인증이나 지불 서비스처럼 클라우드 공급자가 제공하는 서비스를 사용할 수도 있음
- 데이터 서비스
  - 상태 저장이 가능하며 모든 종류의 상태를 저장함
  - 관계형 데이터베이스, 메시지 브로커 등
- 상호작용
  - 클라우드 네이티브 서비스는 시스템의 요구 사항을 충족하기 위해 서로 토잇ㄴ
  - 의사소통이 일어나는 방식은 시스템의 전반적인 특성에 영향을 미침

-----------

## 요약

- 클라우드 네이티브 애플리케이션은 클라우드를 위해 특별히 설계되고 클라우드에 상주하는 고도로 분산된 시슽템
- 클라우드는 컴퓨팅, 스토리지 및 네트워킹 리소스 측면에서 상품으로 제공되는 IT 인프라
- 크랄우드에서는 사용자가 실제 사용하는 리소스에 대해서만 비용르 지불
- 클라우드 네이티브 애플리케이션은 수평적으로 확장 가능하고, 느슨하게 결합되며, 고도로 응집력이 있고, 결함에 잘 견디고, 관리 가능하며 관찰 가능함
