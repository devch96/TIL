# 인프라 아키텍처를 살펴보자

---------------

## 인프라란 무엇일까?

- 전기, 수도, 가스 등 가정에서 이용하는 것이나 지하철, 버스처럼 공공 목적의 인프라.
- 인프라는 우리말로 하면 '기반'이라는 뜻으로, 생활을 지탱하는 바탕이나 토대란 의미.
- 인프라 구조 자체는 복잡하지만, 전문가에 의해 관리되고 있어서 사용자는 그 구조를 이해하지 않고도 간단히 사용할 수 있다는
특징이 있음.
- 아키텍처란 구조라는 의미이다.
  - 기차에도 다양한 종류가 있지만 구조 자체는 거의 같다. 전기로 움직이고, 여러 객차가 연결돼있고, 내부에는 좌석이나 손잡이가 있다.
- 인프라 아키텍처는 IT 인프라의 구조를 의미하며 인터넷 검색 시스템이나 항공 회사 티켓 발권 시스템, 편의점의 계산대 등 모두가 이용 방법이나
사용자가 다르지만 IT 인프라 위에서 동작하고 거의 같은 구조를 가진 채 움직이고 있다.

### 궁극의 아키텍처와 최적의 아키텍처는 존재하는 것일까?

- 어떤 시스템이든지 요건은 거의 비슷하다면, 하나의 만능 아키텍처를 가지고 모든 프로젝트에 적용할 수는 없을까? 라는 의문이 든다.
- 하지만 아키텍처나 설계 요소에는 반드시 장점과 단점이 공존하기 때문에 대답은 NO 다.
  - 100만명이 사용하는 웹 서비스의 예산과 10명이 사용하는 시스템의 예산은 차이가 크다(시스템 도입 비용)
- 시스템의 가장 중요한 장점은 살리고 단점을 최소화하도록 설계하는 것이 중요하다.

-----------------

## 집약형과 분할형 아키텍처

- IT 인프라는 컴퓨터로 구성된다.
- 기본 구성 방식에는 '집약형'과 '분할형'이 있다.

### 집약형 아키텍처

- IT 시스템의 초창기에는 대형 컴퓨터를 이용해서 모든 업무를 처리하는 형태가 대부분이였다.
- 이런 대형 컴퓨터는 '범용 장비,'호스트','메인 프레임' 등으로 불렸다.
- 시스템 아키텍처라는 관점에서 하나의 컴퓨터로 모든 처리를 하기 때문에 집약형이라고 한다.
- 집약형 아키텍처에서는 주요 업무를 모두 한 대로 처리하기 때문에 장비 고장 등으로 업무가 멈추지 않도록, 리소스 관리를 하고, 이중화를 시킨다.
- 한 대의 컴퓨터라고 하지만, 그 안에 마치 여러 사람이 동거하고 있는 모습이라 할 수 있다.
- 많은 기업에서 아직까지 사용되고 있으며 주로 기업 내 핵심 시스템에 사용하고 있는 경우가 있다.
- 장점
  - 한 대의 대형 컴퓨터만 있으면 되므로 구성이 간단하다
  - 대형 컴퓨터의 리소스 관리나 이중화에 의해 안정성이 높고 고성능이다.
- 단점
  - 대형 컴퓨터의 도입 비용과 유지 비용이 비싸다
  - 확장성에 한계가 있다

### 분할형 아키텍처

- 분할형 아키텍처는 여러 대의 컴퓨터를 조합해서 하나의 시스템을 구축하는 구조다.
- 대형 컴퓨터가 했던 처리를 다수의 소형 컴퓨터로 분할 처리하고, 여러 컴퓨터가 연결돼 있어서 데이터를 서로 교환한다.
- 분할형 아키텍처는 표준 OS나 개발 언어를 이용하기 때문에 오픈 시스템, 여러 대의 컴퓨터를 연결해서 이용하기 때문에 분산 시스템이라고 부르기도 한다.
- 장점
  - 낮은 비용으로 시스템을 구축할 수 있다.
  - 서버 대수를 늘릴 수 있어서 확장성이 높다.
- 단점
  - 대수가 늘어나면 관리 구조가 복잡해진다.
  - 한 대가 망가지면 영향 범위를 최소화하기 위한 구조를 검토해야 한다.

#### 물리 서버와 논리 서버의 차이

- 분할형 아키텍처에서 이용되는 컴퓨터를 `서버`라고 한다.
- 서버라는 용어는 컴퓨터 자체(하드웨어)를 가리키는 경우도 있고, 컴퓨터에서 동작하고 있는 소프트웨어를 가리키는 경우도 있다.
- 서버라는 용어는 '특정 역할에 특화된 것' 을 의미한다.
  - 인터넷에 접속했을 때 사용자의 입력 및 HTML 생성을 담당 하는 것은 서버에서 동작하는 소프트웨어인 '웹 서버'
  - 대량의 데이터를 저장해서 요청에 따라 데이터를 제공하는 것은 데이터베이스 기능을 제공하는 'DB 서버'
- 컴퓨터 자체를 가리키는 경우는 '물리 서버' 라고 부른다.
- 웹 서버나 DB 서버(논리 서버)가 하나의 물리 서버에서 동작하는 경우도 있으며, 각각 별도의 물리 서버에서 동작하는 경우도 있다.

----------------------

## 수직 분할형 아키텍처

- 분할형에서는 서버 분할 방식, 즉 역할 분담을 고려해야 한다.
- 각각의 서버가 전혀 다른 작업을 하는 것인지, 아니면 비슷한 작업을 하는 것인지에 대한 관점.
- 수직형이라고 표현하는 것은, 특정 서버 측면에서 봤을 때 역할에 따라 '위' 또는 '아래' 계층으로 나뉘기 때문.

### 클라이언트-서버형 아키텍처

- 업무 어플리케이션, 미들웨어, 데이터베이스 등의 소프트웨어를 물리 서버 상에서 운영하고, 클라이언트(사용자) 측에서 접속해서 이용하는 형태.
- 클라이언트(단말)에 주로 PC가 이용되지만, 최근에는 스마트폰이나 태블릿도 단말로 사용되고 있다.
- 장점
  - 클라이언트 측에서 많은 처리를 실행할 수 있어서 소수의 서버로 다수의 클라이언트를 처리할 수 있다.
- 단점
  - 클라이언트 측의 소프트웨어 정기 업데이트가 필요하다
  - 서버 확장성에 한계가 발생할 수 있다.

### 3계층형 아키텍처

- 클라이언트-서버를 발전시킨 것으로 '프레젠테이션 계층','애플리케이션 계층','데이터 계층' 의 3층 구조로 분할돼있는 아키텍처이다.
- 프레젠테이션 계층
  - 사용자 입력을 받는다
  - 웹 브라우저 화면을 표시한다
- 애플리케이션 계층
  - 사용자 요청에 따라 업무를 처리한다
- 데이터 계층
  - 애플리케이션 계층의 요청에 따라 데이터 입출력을 한다
- 클라이언트-서버형에 비해 특정 서버에 부하가 집중되는 문제가 해결된다는 것이 장점이며 업무 어플리케이션 갱신에 따른 클라이언트 업데이트가
필요 없으며 사용자는 웹 브라우저만 준비하면 된다.
- 모든 처리가 AP 서버나 DB서버를 이용하지 않아도 된다.
  - 이미지 파일만 읽으면 되는 경우라면 웹 서버만으로 처리 완료 가능
- 장점
  - 서버 부하 집중 개선
  - 클라이언트 단말의 정기 업데이트가 불필요
  - '처리 반환'에 의한 서버 부하 저감
- 단점
  - 구조가 클라이언트-서버 구성보다 복잡.

---------------------------

## 수평 분할형 아키텍처

- 서버별로 다른 역할을 하도록 시스템을 수직으로 확장하는것이 수직 분할이라면, 수평 분할은 용도가 같은 서버를 늘려나가는 방식이다.
- 서버 대수가 늘어나면 한 대가 시스템에 주는 영향력이 낮아져서 안정성이 향상된다. 또한 처리를 담당하는 서버 대수가 늘어나면 전체적인 성능 향상도 실현할
수 있다.
- 수직 분할형과 수평 분할형은 배타적인 관계가 아니며 대부분의 시스템이 이 두 가지 방식을 함께 채택하고 있다.

### 단순 수평 분할형 아키텍처

- 같은 기능을 가진 복수의 시스템으로 단순 분할한다.
- 수평 분할을 'Sharding(샤딩)'이나 'Partitioning(파티셔닝)'이라 부르기도 한다.
- 시스템을 단순히 분할함으로서 전체 처리 성능을 두 배로 향상시킬 수 있고, 한 쪽에서 장애가 발생하더라도 다른 쪽에 영향을 주지 않는다.
- 하지만 같은 애플리케이션을 사용하고 있다면 업데이트도 두번 해야 하고, 처리량이 한쪽으로 몰려있는 상황이라면 성능이 두배라고 말하긴 어렵다.
- 거리상으로 멀리 떨어진 시스템 혹은 공장처럼 각 거점이 완전히 독립된 운영을 하고 있는 경우에 사용된다.
- 장점
  - 수평으로 서버를 늘리기 때문에 확장성이 향상된다
  - 분할한 시스템이 독립적으로 운영되므로 서로 영향을 주지 않는다
- 단점
  - 데이터를 일원화해서 볼 수 없다.
  - 애플리케이션 업데이트는 양쪽을 동시에 해 주어야 한다
  - 처리량이 균등하게 분할돼 있지 않으면 서버별 처리량에 치우침이 생긴다

### 공유형 아키텍처

- 공유형에서는 단순 분할형과 달리 일부 계층에서 상호 접속이 이루어진다
- 장점
  - 수평으로 서버를 늘리기 때문에 확장성이 향상된다
  - 분할한 시스템이 서로 다른 시스템의 데이터를 참조할 수 있다
- 단점
  - 분할한 시스템 간 독립성이 낮아진다
  - 공유한 계층의 확장성이 낮아진다

#### 집약 -> 분산 -> 집약 -> 분산

- 오픈화(분산) -> 가상화/클라우드화(집중) -> 엣지 컴퓨팅(분산) 이러한 형태로 집약과 분산이 반복됨.
- 가상화를 사용해 데이터 센터를 통합하거나 클라우드로 이전하면서 네트워크 대역과 비용이 크게 증가해서 지리적으로 가까운 위치에 있는
서버로 처리를 분산하고 처리 결과만 중앙으로 보내는 엣지 컴퓨팅 아키텍처가 각광받고 있다.

-----------------------

## 지리 분할형 아키텍처

- 서버를 수직 또는 수평으로 분할하여 조합함으로써 목적에 적합한 구성을 만들 수 있었다.
- 업무 연속성 및 시스템 가용성을 높이기 위한 방식

### 스탠바이형 아키텍처

- 스탠바이 구성, HA(High Availability)구성, 액티브-스탠바이 구성 등으로 불린다.
- 물리 서버를 최소 두 대를 준비하여 한 대가 고장 나면 가동 중인 소프트웨어를 다른 한 대로 옮겨서 운영하는 방식
- 소프트웨어 재시작을 자동으로 하는 구조를 '페일오버(Failover)', 페일,F/O 라고 부른다
- 물리 서버 고장에 대처할 수 있지만, 보통 때는 페일오버 대상 서버(스탠바이)가 놀고 있는 상태가 되기 때문에 리소스 츨면에서 낭비가 발생한다.
  - 이 문제를 해결하기 위해 스탠바이를 따로 두지 않고, 양쪽 서버를 동시에 교차 이용(한쪽이 고장 나면 다른 한쪽이 양쪽을 처리)하는 경우도 많다.
- 물리 서버가 아닌 가상화 서버를 이용하고 있는 경우는 서버상의 소프트웨어 뿐만 아니라 가상 서버별로 다른 물리 서버에
페일오버하는 방식도 선택될 수 있다.

### 재해 대책형 아키텍처

- 재해 발생이 현실적인 문제가 되고 있으면서 인프라 아키텍처에서도 재해에 대응하기 위해 재해 복구 구성을 취하는 일이 잦아지고 있다.
- 특정 데이터 센터에 있는 상용 환경에 고장이 발생하면 다른 사이트에 있는 재해 대책 환경에서 업무 처리를 재개하는 것이다.
- 이 아키텍처에서는 애플리케이션 최신화와 데이터 최신화가 중요하다.
- 저장소 장비 기능, OS 기능, 데이터베이스 기능 등 동기 처리를 위한 방법과 각각의 비용, 대상 데이터, 동기 연장 특성 등을 고려해서 결정해야 한다.