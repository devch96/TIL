# 커밋

- 코드의 변화를 기록하는 것

----------------

## 코드의 변화

- 커밋은 의미 있는 변경 작업들을 저장소에 기록하는 동작
- 새로운 기능을 추가하는 코드를 삽입하고 변경 시점을 저장해둠
- 특정 시점으로 되돌아갈 수 있음

### 파일 관리 방법

- 깃이 없으면 파일을 복사해서 다른 이름으로 저장함
- 파일을 많이 생성해야 하고 중복되기 때문에 용량도 많이 차지함

--------------

## 새 파일 생성 및 감지

- 파일을 생성하면 워킹 디렉터리에 파일 이름으로 저장됨

### 깃에서 새 파일 생성 확인

- 워킹 디렉터리에 새 파일이 추가되면 깃은 변화된 상태를 자동으로 감지함

---------------

## 깃에 새 파일 등록

- 워킹 디렉터리에 있는 파일은 깃이 자동으로 추적 관리하지 않음.
- 커밋하려면 파일의 상태가 추적 가능해야 함

### 스테이지에 등록

- 등록이란 워킹 디렉터리에 있는 파일을 스테이지 영역으로 복사하는 것을 의미
  - 실제 파일 복사가 아닌 논리적인 기록을 변경하는 것
- add 명령어는 워킹 디렉터리의 파일을 스테이지 영역으로 등록함
  - git add 파일이름
- 파일 이름 대신 디렉터리를 선택할 수도 있음

### 파일 등록 취소

- stage 상태를 unstage 상태로 변경하려면 삭제나 리셋 명령어를 사용
- rm 명령어 혹은 reset 명령어 사용
- git rm --cached [파일 이름] 
  - stage 영역에서만 등록된 파일을 삭제하려고 --cached 옵션 사용
- 하지만 한 번이라도 커밋을 했다면 reset 명령어를 사용해야 함
- git reset HEAD [파일 이름]

### 등록된 파일 이름이 변경되었을 때

- 파일 이름을 변경했다고 별도로 깃에 통보할 필요 없이 mv 명령어를 사용
- git mv 파일이름 새파일이름
  - mv a b
  - git rm a
  - git add b
  - 의 과정

------------------

## 첫 번째 커밋

### HEAD

- HEAD는 커밋을 가리키는 묵시적 참조 포인터
- HEAD는 최종적인 커밋 작업의 위치를 가리킴
- 새로운 커밋은 이전 부모 커밋을 기반으로 새로운 커밋을 만듬
- HEAD는 부모 커밋을 가리킴
- HEAD는 커밋이 변화한 최종 시점을 의미

### 스냅샷

- 커밋은 파일 변화를 깃 저장소에 영구적으로 기록
- 스냅샷 방식을 사용
- 파일을 복사하는 방식으로 수정본을 관리하면 같은 내용을 반복해서 저장하기에 많은 용량을 차지하고, 수정된 부분들을 일일이 찾아야 하기 때문에
검색할 때도 불편함
- 파일 전체를 저장하는 것이 아닌 파일에서 변경된 부분을 찾아 수정된 내용만 저장
- 변화된 부분만 찾아 사진을 찍는 것과 같다고 하여 스냅샷 방식이라고 함
- 스냅샷은 HEAD가 가리키는 커밋을 기반으로 사진을 찍음

### 파일 상태와 커밋

- commit 명령어
- 커밋은 별도로 작성한 메시지 문자열로 각 변경 객체들을 쉽게 구분함
- 따라서 모든 커밋은 반드시 메시지를 작성해야 함
- commit 명령어만 치면 지정된 에디터가 열림
  - 아무 내용도 넣지 않고 종료하면 커밋 명령 취소
- git commit -a 를 하면 add와 commit을 동시에 사용할 수 있음

------------

## 커밋 확인

### 로그 기록 확인

- log  명령어
  - git log
- 시간 순으로 커밋 기록을 출력하는데 최신 커밋 기록부터 내림차순으로 나열

-------------

## 두 번째 커밋

- 커밋한 파일을 수정하면 modified 상태가 되면서 스테이지에서 내려옴

### 수정된 파일 되돌리기

- 수정하는 과정에서 파일을 잘못 수정했을 경우 수정 전 상태로 되돌려야 함
- git checkout -- 수정파일이름
- 수정 내역은 모두 삭제함

---------------

## 메시지가 없는 빈 커밋

- 의미가 없는 커밋이라 커밋 메시지를 생략하고 싶을 때 사용
- git commit --allow-empty-message -m ""

### 메시지 수정

- 커밋 메시지를 입력할 때 오타가 발생할 수 있음
- 방금 전 작성한 커밋 메시지를 수정하는 것은 --amend 옵션

---------------

## 커밋 아이디

- 커밋 아이디는 다수의 커밋을 구분할 수 있는 키이며 브랜치나 태그 등에도 많이 사용함

### SHA1

- SHA1이라는 해시 알고리즘을 사용해서 커밋 아이디를 만듬
- 중복되지 않은 고유의 키를 생성할 수 있는 장점

### 단축키

- SHA1 해시키는 매우 큰 숫자이기 때문에 고유 접두사로 간략하게 사용할 수 있는데, 해시의 앞쪽 7자만으로도 중복을 방지하면서
전체 키 값을 사용할 수 있다.

---------------

## 커밋 로그

### 간략 로그

- 로그를 출력할 때 첫 번째 줄의 커밋 메시지만 출력
  - git log --pretty=short
- 특정 커밋의 상세 정보를 확인하고 싶다면
  - git show 커밋ID
- 특정 파일의 로그 기록
  - git log 파일이름
- diff 기능(수정한 라인 비교)을 같이 포함하여 출력
  - git log -p
- 히스토리 출력
  - git log --stat

--------------------

## diff 명령어

- diff 명령어는 커밋 간 차이를 확인

### 파일 간 차이

- diff 기능으로 파일의 수정 및 변경 내역을 쉽게 파악할 수 있음

### 워킹 디렉터리 vs 스테이지 영역

- 아직 add 명령어로 파일을 추가하지 않은 경우 워킹 디렉터리와 스테이지 영역 간 변경 상항을 비교할 수 있음.
  - git diff

### 커밋 간 차이

- 최신 커밋과 변경 내용을 비교하여 볼 수 있음
  - git diff head