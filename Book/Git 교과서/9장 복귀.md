# 복귀

----------

## 되돌리기

- 깃을 이용하여 버전을 관리하는 목적은 만일의 사태를 대비하여 되돌아가기 위한 것
- 코드 복구 시스템과 같음

### 다시 시작

- 깃에서 코드를 되돌리는 방법은 크게 reset과 revert 두 가지

---------

## 리셋

- 리셋(reset)은 커밋을 기준으로 이전 코드로 되돌리는 방법으로 기록한 커밋을 취소함
- 커밋을 취소하는 만큼 리셋할 때는 항상 신중하게 작업해야 함

### 복귀 시점

- 이전 코드로 복귀하려면 복귀 시점을 알려주어야 함
- 리셋은 이 시점을 커밋을 기준으로 함
- 고정된 커밋 해시 값을 사용하지 않고, HEAD 포인터를 이용하여 상대적 위치를 지정할 수 있음

### reset 명령어

- 특정 커밋의 해시 값 상태로 모든 코드를 복구함
- git reset 옵션 커밋ID
- 옵션
  - soft: 스테이지 영역을 포함한 상태로 복원
  - mixed: 기본 옵션 값.
  - hard: 실제 파일이 삭제된 이전 상태로 복원

### soft 옵션

- 커밋이 삭제되지만 파일의 달라진 점이 없음.
- 수정된 파일은 스테이지 영역에 등록
- 지정한 커밋 위치로 복귀하면서 스테이지 영역의 상태도 같이 복귀
- 파일을 수정하고, add 명령어로 스테이지 영역에 올려 커밋을 실행하기 직전의 단계로 되돌림
- HEAD 위치를 이동하는 역할
- 새로 커밋하면 변경된 시간 같은 값을 적용하여 해시 값을 생성하기 때문에 이전 커밋 값과 다름

### mixed 옵션

- soft 옵션과 달리 리셋한 후 스테이지 상태까지 복원하지 않음
- 커밋하려면 add 명령어를 먼저 실행해야 함

### hard 옵션

- soft 옵션과 mixed 옵션은 이전 커밋으로 되돌리는 과정에서 실제로 삭제되는 내용은 없음. 모든 작업 내용이 워킹 디렉터리에 그대로 유지됨.
- 이전 상태로 되돌아가는 것이 아닌 복귀 커밋 이후의 작업들은 워킹 디렉터리 영역에 남겨 두어 다시 수정하거나 커밋할 수 있도록 상태만 변경하는 것
- hard 옵션은 리셋되는 복귀 시점의 커밋 상태와 해당 커밋의 워킹 디렉터리까지 모두 되돌림.
- reset --hard 명령어를 사용한 커밋 이후의 모든 내용은 삭제
- 주의해서 사용해야 함

### 스테이지 리셋

- 스테이지 영역은 커밋을 하려고 임시로 결과물을 보관해 두는 영역
- 스테이지 영역에 등록
  - git add 파일이름
- 스테이지 영역의 파일을 다시 unstage 상태가 되도록 스테이징 취소
  - git reset 파일이름

### 작업 취소

- 수정 작업을 완전히 취소하려면 워킹 디렉터리와 스테이지 상태를 모두 제거하여 마지막 커밋 상태로 되돌려 놓아야 함
- git reset --hard HEAD

### 병합 취소

- 방금 전 병합한 커밋을 리셋하여 취소
- git reset --merge HEAD~

### 주의할 점

- 리셋 기능을 이용하면 개인 프로젝트를 관리할 때 쉽게 이전 상태로 복귀할 수 있음
- 저장소를 외부에 공개했거나 공유하고 있다면 주의해서 리셋을 사용해야 함
-  협업하거나 소스 코드를 공유한 후에는 리셋 작업을 하지 않음.

-------------

## 리버트

- 공개한 저장소에서 이전 상태로 되돌리기

### 취소 커밋

- 리셋은 기존 커밋 정보를 삭제하는 반면, 리버트는 기존 커밋을 남겨 두고 취소에 대한 새로운 커밋을 생성함
- 취소 커밋은 지정한 커밋을 삭제하지 않고, 삭제를 위한 새로운 커밋을 생성
- 직전의 커밋을 리버트
- git revert HEAD

### 리버트 지정

- 리버트는 한 번에 커밋 하나만 취소할 수 있음.
- 리버트를 최신 커밋부터 순차적으로 취소해야 함
- 직전의 커밋이 아닌 다른 커밋을 취소할 때는 커밋 해시 값 지정
- git revert 커밋ID
- 깃의 범위 지정 연산자를 이용해 여러 커밋을 리버트할 수도 있음
- git revert 커밋ID..커밋ID

### 병합 취소

- reset은 방금 전 실행한 병합만 삭제하지만 리버트는 시간이 지난 후에도 과거의 병합을 선택하여 취소할 수 있음
- 리버트로 병합 취소
- git revert --mainline 숫자 병합커밋ID
- 리버트로 병합이 취소 상태가 되면 둘 중 한 브랜치로 체크아웃해야 한다. --mainline 옵션은 병합을 취소한 후 체크아웃되는 브랜치를 표시
- --mainline은 체크아웃으로 되돌아가는 커밋 번호