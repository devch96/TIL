# 서브모듈

----------

## 대형 프로젝트

### 저장 용량

- 깃 저장소는 하드디스크에 지우너하는 용량만큼 깃 저장소를 생성할 수 있음.
- 파일 개수가 많은 프로젝트에서는 좀 더 효율적인 관리 방법이 필요

### 저장소 분리

- 저장소 하나를 작은 저장소 몇 개로 분할할 수 있음.
- 서브모듈은 저장소 하나가 다른 깃 저장소를 포함하는 형태를 의미

### 상하 관계

- 규모가 큰 프로젝트는 모듈화하여 개발하는 추세
- 각 기능들은 모듈화하여 독립된 깃 저장소로 관리
- 메인 저장소와 서브 저장소 관계로 나뉨

-----------

## 서브모듈 추가

- 서브모듈은 2개 이상인 저장소를 부모와 자식 관계로 연결
- git submodule

### 저장소 연결

- 메인 저장소에 자식 저장소를 추가하는 옵션은 add
- 메인 저장소는 서브 저장소를 서브 폴더 형태로 취급
- 자식 저장소를 등록할 때는 자식 저장소와 연결된 원격 저장소 주소를 입력
- git submodule add https:// ~~(자식)
- 자식 저장소와 연결된 원격 저장소에 복제(clone)함

### 설정 파일

- 메인 저장소에 서브모듈이 등록되면 깃은 루트 위치에 설정 파일을 생성
- 설정 파일은 메인 저장소와 연결된 자식 저장소들을 관리
- 설정 파일 이름은 .gitmodules

### 모듈 커밋

- 메인 저장소가 자식들의 정보를 계속 가지려면 이를 커밋해서 저장해야 함

-------------

## 서브모듈 작업

- 메인 저장소에 등록된 서브 저장소는 독립된 별도의 저장 공간

### 모듈 저장소

- 서브모듈 안에 .git 폴더 존재
- 서브 폴더는 서브모듈로 분리한 독립된 깃 저장소
- 서브 폴더안에서 작업을 하면 서브 폴더는 변경된 파일을 추적하고 메인 모듈은 서브모듈의 저장소 자체를 추적함

### 모듈 커밋

- 메인 저장소에서 하위로 복제 생성된 자식 저장소에만 커밋

### 부모 커밋

- 서브 모듈을 수정한 후 커밋했다면 메인 저장소의 서브 모듈도 변경되기 때문에 커밋해야함

-------------

## 자식 저장소 갱신

### 자식 저장소

- 자식 저장소와 메인 저장소에 등록된 저장소는 서로 다른 영역

### 자식 저장소 갱신

- 메인 저장소에 등록된 서브모듈의 커밋은 자식의 원격 저장소로 푸시
- 수정 반영된 커밋을 실제 자식 저장소로 가져와야 함

### 자식 저장소 작업

- 자식 저장소에서 작업을 하고 푸쉬

### 부모 저장소 적용

- 부모 저장소에서 서브 모듈 저장소로 가고 pull

### 부모 저장소 갱신

- 부모 저장소는 서브모듈의 갱신을 파악함
- 다시 push

-------------

## 부모 저장소 복제

- 서브모듈로 구성된 저장소는 부모/자식 관계를 맺음
- 서브모듈의 저장소를 복제하거나 배포할 때는 부모/자식 관계도 같이 복제해야 함

### 모듈 업데이트

- 메인 저장소를 복제할 때는 서브모듈 정보만 같이 복제할 뿐 실제 하위 저장소는 같이 복제하지 않음
- 하위 저장소의 내용을 가져오려면 먼저 초기화와 갱신 작업을 해야 함
- git submodule init
- git submodule update
- update 옵션으로 관련 하위 저장소를 복제함

--------------

## 부모 저장소 업데이트

### 부모 업데이트

- 자식 저장소에 코드 수정으로 커밋이 발생하면, 부모에도 새로운 커밋이 발생함

### 부모 저장소로 풀

- 하위 저장소에 새로운 커밋이 생성되면 메인 저장소는 이를 반영함
- 메인 저장소를 복제하여 운영한다면 주기적으로 pull 해주어야 하는데 이때 서브 저장소까지 자동으로 갱신되지 않으므로
update 명령을 실행해야 함
  - git pull origin master
  - git submodule update
