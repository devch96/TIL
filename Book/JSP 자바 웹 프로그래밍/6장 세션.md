# 세션(Session)

-----------

## 세션이란?

- 클라이언트가 웹 브라우저를 통해 서버에 접속한 후 용무를 처리하고 웹 브라우저를 닫아 서버와의 접속을 종료하는 하나의 단위
- 클라이언트가 서버에 접속해 있는 동안 그 상태를 유지하는 것이 목적

-----------

## 세션 설정, 확인, 삭제

### 유지 시간 설정

- 세션은 웹 브라우저를 실행할 때마다 새롭게 생성됨
- 생성된 세션은 설정된 유지 시간 동안 유지되며 유지 시간이 만료되기 전에 새로운 요청이 들어오면 수명이 계속 연장됨
- 만료 때까지 클라이언트가 아무런 요청을 하지 않거나 웹 브라우저를 닫으면 삭제됨
- 세션의 유지 시간을 설정하는 방법은 2가지
  - web.xml에서 설정
    - 유지 시간을 분 단위로 설정함
  - JSP 파일에서 session 내장 객체가 제공하는 setMaxInactiveInterval()을 사용
    - 시간 단위는 초

### 설정값 확인

- 세션에는 유지 시간 외에도 몇 가지 속성이 더 있음
  - 다른 세션과 구분하기 위한 아이디
  - 최초 요청 시각(생성 시각)과 마지막 요청 시각 등의 속성
```html
<%
session.getMaxInactiveInterval();
session.getId()
long creationTime = session.getCreationTime();
long lastTime = session.getLastAccessedTime();
%>
```

### 세션 삭제

- 웹 브라우저를 닫으면 종료됨
- 브라우저 설정에서 모든 쿠키를 삭제해 세션을 삭제하는 방법도 있음

1. 웹 브라우저가 처음 접속하면 서버(톰캣)는 세션을 새로 생성하고 응답 시 세션 아이디를 값으로 갖는 JSESSIONID 쿠키를 응답 헤더에 담아 웹 브라우저에 보냄
2. 웹 브라우저는 재요청 시마다 JSESSIONID를 요청 헤더에 추가하여 보냄
3. 서버는 요청 헤더에 포함된 JSESSIONID로 해당 요청이 기존 세션에서 이어진 것임을 알게 됨

-----------

## 쿠키 vs 세션

- 쿠키
  - 클라이언트 PC에 text로 저장됨
  - 클라이언트에 저장되므로 보안에 취약
  - 서버 자원을 사용하지 않으므로 세션보다 빠름
  - 용량의 제한이 있음
  - 쿠키 생성 시 유지 시간을 설정, 설정된 시간이 경과되면 무조건 삭제됨
- 세션
  - 웹 서버에 Object 타입으로 저장됨
  - 서버에 저장되므로 보안에 안전함
  - 서버 자원을 사용하므로 쿠키보다 느림
  - 서버가 허용하는 한 제한이 없음
  - 서버의 web.xml에서 세션 유지시간을 설정함.

----------

## 핵심 요약

- 세션은 클라이언트가 웹 브라우저를 통해 서버에 접속한 후 웹 브라우저를 닫을 때까지의 단위를 뜻함
- 클라이언트가 서버에 접속한 동안 상태를 유지하기 위해 세션 영역을 이용하 상태 정보를 저장함
- 세션의 유지 시간 설정은 web.xml을 이용하는 것이 편리함
- 설정된 유지 시간 동안 아무런 동작이 없다면 세션은 소멸됨. 하지만 동작이 있다면 계속 유지됨
- 세션 영역은 다른 페이지와도 공유되므로 클라이언트별 상태 정보를 관리하기에 아주 유용한 수단임.