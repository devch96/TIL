# 예측 가능한 코드를 작성하라

- 궁극적으로 개발자는 코드를 사용하는 방법에 대한 정신 모델을 구축함
  - 정신 모델은 코드 계약에서 발견한 것, 사전 지식, 적용할 수 있다고 생각하는 공통 패러다임에 근거해 만들어짐
- 코드가 실제로 하는 일이 이 정신 모델과 일치하지 않는다면 예측과 벗어나는 기분 나쁜 일이 일어날 가능성이 큼
- 예측 가능한 코드를 작성하는 것은 무언가를 분명하게 하는 것일 때가 많음
  - 함수가 아무것도 반환하지 않을 때가 있거나 처리해야 할 특별한 시나리오가 있는 경우 다른 개발자에게 확실히 알려야함
  - 그러지 않으면 코드의 동작이 다른 개발자에게 실제 일어날 것이라고 생각하는 것과 일치하지 않을 위험이 있음

-----------

## 매직값을 반환하지 말아야 한다

- 매직값(magic value)은 함수의 정상적인 반환 유형에 적합하지만 특별한 의미를 가지고 있는 것
- 매직값의 일반적인 예는 값이 없거나 오류가 발생했음을 나타내기 위해 -1을 반환하는 것
- 매직값은 함수의 정상적인 반환 유형에 들어맞기 때문에 이 값이 갖는 특별한 의미를 인지하지 못하고 정상적인 반환값으로 오인하기 쉬움

### 매직값은 버그를 유발할 수 있다

- 일부 레거시 코드와 언어의 내장된 함수들(javascript의 배열에 대해 indexOf()를 호출할 때)중에 매직값을 리턴하는 경우가 있음
- 과거에는 명시적인 오류 전달 기법이나 널 또는 옵셔널 타입을 반환하는 것이 가능하지 않거나 실용적이지 않기 때문에 매직값을 반환하는 것이 어느 정도 합리적인
이유가 있었음
- 레거시 코드로 작업 중이거나, 신중하게 최적화해야 하는 코드가 있다면 여전히 이렇게 할 이유가 있을 수 있지만 일반적으로는
매직값을 반환하면 예측을 벗어날 위험이 있으므로 사용하지 않는 것이 가장 바람직함

### 해결책: 널, 옵셔널 또는 오류를 반환하라

- 함수에서 매직값을 반환할 때의 문제점은 호출하는 쪽에서 함수 계약의 세부 조항을 알아야 하지만 어떤 개발자들은 이 세부 조항을 확인하지 않거나
확인하고나서 잊어버리기 때문에 예측을 벗어나는 일이 생길 수 있음
- 널 안전성을 지원하는 경우에는 널이 가능한 유형을 반환하고, 널 안전성을 지원하지 않는 경우에는 옵셔널 값을 반환하면 됨

### 때떄로 매직값이 우연히 발생할 수 있다

- 개발자가 자신의 코드에 주어지는 모든 입력과 이러한 입력값들이 어떤 영향을 미칠 수 있을지에 대해 충분히 생각하지 않을 때도 매직값은 반환될 수 있음

```java
Integer minValue(List<Integer> values) {
    Integer minValue = Integer.MAX_VALUE;
    for (Integer value : values) {
        minValue = Math.min(value, minValue);
    }
    return minValue;
}
```

- Integer.MAX_VALUE는 values 리스트가 비어 있으면 반환됨
  - 우연히 반환되는 것이 아닐 수 있음
