# 코드 더 잘 읽기

- 코드 읽는 법을 배울 기회도 없지만 연습하지도 않는다.

----------

## 코딩 중 겪는 혼란에 대한 이해

- 프로그래밍을 하다 보면 늘 혼란이 일어남
  - 새로운 프로그래밍 언어나 개념
  - 프레임워크를 배울 때 접하는 새로운 아이디어
  - 익숙하지 않은 코드나 오래전에 작성한 코드
  - 접해보지 못한 도메인 영역에서 일을 새로 시작할때 도메인 특화 용어

### 코드가 초래하는 세 가지 종류의 혼란

- 숫자n을 이진수로 바꾸는 예

#### 혼란의 첫 번째 유형: 지식의 부족

- APL 코드

```
2 2 2 2 2 T n
```

- 코드가 혼란스러운 이유는 T에 대한 지식(knowledge)이 없기 때문

#### 혼란의 두 번째 유형: 정보의 부족

- 자바 코드

```java
public void BinaryCalculator(Integer n) {
    System.out.println(Integer.toBinaryString(n));
}
```

- toBinaryString() 메서드가 내부적으로 어떻게 작동하는지 모른다면 이 코드도 혼란스러울 수 있음
  - 메서드 이름으로부터 유추할 수 있겠지만 구체적으로 어떤 일을 수행하는지 이해하려면 내부를 더 살펴봐야함
  - 정보(information)가 부족함

#### 혼란의 세 번째 유형: 처리 능력의 부족

- 변수 이름이나 연산자를 통해 코드가 무슨 일을 하는지 유추할 수 있으나 코드를 따라가다 보면 머릿속에서 모든 과정을 처리하기 어려움
- 베이직 코드

```
LET N2 = ABS(INT(N))
LET B$ = ""
FOR N1 = N2 TO 0 STEP 0
    LET N2 = INT(N1/2)
    LET B$ = STR$(N1 - N2 * 2) + B$
    LET N1 = N2
NEXT N1
PRINT B$
```

- 처리 능력(processing power)이 부족하기 때문
- 변수에 임시로 저장되는 값을 모두 다 기억하거나 각각의 경우 어떤 동작들이 수행되는지를 동시에 알기 어려움

### 코딩에 영향을 주는 인지 과정

- 세 가지 서로 다른 종류의 혼란은 각각 서로 다른 종류의 인지 과정과 연관되고, 이 과정은 기억과 관련 있음
- 지식이 없다 : 두뇌의 장기 기억 공간(long-term memory, LTM)에 해당 내용이 없다는 것을 뜻함
- 지식이 아닌 정보가 부족 : 단기 기억 공간(short-term memory, STM)에 해당 내용이 없기 때문
- 처리 능력 부족 : 작업 기억 공간(working memory)의 문제
- 세 가지 인지 과정은 코드를 분석, 작성, 시스템 설계, 문서 작성과 같이 모든 종류의 인지 활동에 나타남

#### LTM과 프로그래밍

- LTM은 오랜 시간 동안 저장한다는 점에서 하드 드라이브와 비슷
- APL 프로그램: LTM
  - T의 의미를 몰라서 코드가 안읽힘
  - 언어의 문법에 대한 지식도 중요하다는 사실

#### STM과 프로그래밍

- STM은 들어오는 정보를 잠시 보관하기 위해 사용
  - 코드에서 키워드, 변수명, 자료구조 등
- 자바 프로그램: STM
  - toBinaryString() 메서드가 내부적으로 어떤 일을 수행하는지 알지 못함
  - STM이 주된 역할을 하지만 LTM도 어느 정도 역할이 있음
- STM은 값을 일시적으로 저장하는 캐시나 메인 메모리와 비슷

#### 작업 기억 공간과 프로그래밍

- STM과 LTM은 거의 기억장치인 반면, 작업 기억 공간은 프로세서라고 볼 수 있음
- 베이직 프로그램: 작업 기억 공간
  - 머리가 코드를 실행해보면서 무슨 일이 일어날지 이해하려 시도
    - 트레이싱(tracing: 추적)이라고 부르는 행위
    - 머리속에서 코드를 컴파일하고 실행하는 과정

### 인지 과정들의 상호작용

- LTM은 오랜 시간에 걸쳐 얻은 정보를 저장하는 장소
- STM은 방금 전에 읽거나 들은 정보를 일시적으로 저장하는 장소
- 작업 기억 공간은 정보를 처리하고 새로운 사고 작용을 형성하는 곳

#### 인지 과정들이 어떻게 상호작용하는지에 대한 간단한 설명

- 자바 코드 예
  - n이 정수형이라는 정보는 STM에 저장
  - 정수 그 자체에 대한 정보는 LTM에서 인출
  - 프로그램이 무엇을 하는지 파악하는 일은 작업 기억 공간에서 이루어짐

#### 프로그래밍 업무와 관련한 인지 과정

- 버그 리포트 받는 상황 예
  - 버그 리포트는 시각이나 청각 같은 지각을 통해 두뇌로 입력
  - 코드 분석을 할 때 읽는 내용은 STM에 저장되며 동시에 몇 개월 전 구현한 내용을 LTM에서 인출
  - 오류의 해결법 같은 정보 역시 LTM에 저장

### 요약

- 코드를 읽을 때 혼란이 생기는 이유는 지식 부족, 쉽게 찾을 수 있는 정보의 부족, 두뇌의 처리 능력의 부족
- 코드를 읽거나 작성할 때 세 가지 인지 과정이 일어남
  1. LTM에서 정보를 인출하는 것으로 키워드의 의미 같은 것들이 여기에 해당.
  2. 메서드나 변수의 이름과 같이 코드를 읽는 과정에서 발생하는 정보를 STM에 일시적으로 저장
  3. 작업 기억 공간: 코드를 읽고 처리하는 일

----------------

## 신속한 코드 분석

- 연구에 의하면 프로그래머의 시간 중 거의 60%는 코드를 작성하는 것이 아닌 이해하는데 사용한다고 함
  - 정확도를 유지하면서 코드를 빨리 이해하도록 향상한다면 프로그래밍 기술이 크게 개선됨

#### 코드를 신속하게 읽기

- 유명한 문장이 있다
  - "프로그램은 사람이 읽을 수 있도록 작성해야만 한다. 기계가 실행하는 것은 부차적인 일이다"
  - 이 말이 사실임에도 코드를 읽는 법보다 작성하는 법을 더 많이 연습한다.
- 코드를 읽는 목적은 다양
  - 기능 추가
  - 버그 발견
  - 코드가 실행될 더 큰 시스템을 이해
  - ...
- 우리는 코드를 읽을 때 그 코드에 존재하는 특정한 정보를 찾기 위해 읽음
  - 기능 추가할 적당한 부분
  - 수정한 코드 중 특정 버그가 있을 만한 곳
  - 특정 메서드가 어떻게 구현 됐는지 등
- 코드 읽는 기술의 수준이 높아지면 추가 정보를 찾기 위해 코드 여기저기 살피는 횟수가 줄어듬
  - 좀 더 효율적인 프로그래머가 될 수 있음
  - 코드를 찾는데 허비할 시간에 버그를 고치거나 기능 추가 가능

#### 두뇌에서 무슨 일이 일어나는가?

```java
public class InsertionSort {
    public static void main(String[] args) {
        int[] array = {1,2,3,4,5,6,7,8};
        int temp;
        for (int i = 1; i < array.length; i++) {
            for (int j = i; j > 0; j--) {
                if(array[j] < array[j-1]){
                    temp = array[j];
                    array[j] = array[j-1];
                    array[j-1] = temp;
                }
            }
        }
    }
}
```

- 코드를 읽는 과정에서 어떤 정보들을 STM에 저장
- LTM은 두 가지 방법으로 여기에 정보를 추가
  - 자바 문법에 대한 지식은 LTM
    - for 루프 등..
  - 이 코드가 삽입 정렬을 구현한다는 사실을 알고 있다는 점

#### 생소한 코드를 읽는 것은 왜 어려운가?

```java
public void execute(int x[] ) {
    int b = x.length;
    for (int v = b / 2 - 1; v >= 0; v--) {
        func(x, b, v);
    }
    for (int l = b - 1; l > 0; l--) {
        int temp = x[0];
        x[0] = x[l];
        x[l] = temp;
        func(x, l, 0);
    }
}
```

- 코드가 무슨 일을 하는지 알지 못하기 때문에 기억이 나지 않는 부분을 LTM에 저장된 지식을 사용해 추측 불가
- for 루프의 변수명을 b나 l처럼 잘 쓰지 않는 이상한 이름을 사용
- 코드에 있는 정보를 모두 다 STM에 저장하고 처리하는 것은 물리적으로 불가능
  - 연구에 의하면 30초를 넘지 않음

### 기억의 크기 제한을 극복하기

#### 단위로 묶는 것의 위력

- 체스 말 위치 외우는 실험
  - 일반 플레이어는 말의 위치를 하나씩 기억
    - A7에 룩, B5에 폰
  - 전문가 그룹은 LTM에 저장되어 있는 지식 활용
    - 시실리언 오프닝에서 나이트 하나는 2칸 왼쪽 등
- 몇 개의 그룹으로 묶은 정보를 청크(chunk)라고 함
  - 시실리언 오프닝은 하나의 청크이므로 STM의 기억 공간 하나만을 차지
- LTM에 지식이 많으면 기억을 쉽게 한다는 사실은 프로그래밍에도 해당

### 읽는 것보다 보는 것이 더 많다

- 정보는 STM에 도달하기 전 감각 기억 공간(sensory memory)이라는 영역을 통과
  - 입출력 버퍼와 같은 곳

#### 영상 기억 공간

- 정보가 감각기관을 통해 들어오면 STM으로 전달되기 전 감각 기억 공간에 저장
  - 코드를 읽을 때 눈을 통해 정보가 들어오는데 이 정보는 영상 기억 공간에 잠시 저장
- 