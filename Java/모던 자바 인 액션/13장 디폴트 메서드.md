# 디폴트 메서드

- 전통적인 자바에서 인터페이스와 관련 메서드는 한 몸처럼 구성된다.
- 인터페이스를 구현하는 클래스는 인터페이스에서 정의하는 모든 메서드 구현을 제공하거나 아니면 슈퍼클래스의 구현을
상속받아야 한다.
- 평소에는 아무런 문제가 없지만 라이브러리 설계자 입장에서 인터페이스에 새로운 메서드를 추가하는 등 인터페이스를 바꾸고 싶을 때는 문제가 발생한다.
  - 많은 클래스의 구현을 고쳐야 하기 때문
- 자바 8에서는 이 문제를 해결하는 새로운 기능을 제공한다.
- 자바 8에서는 기본 구현을 포함하는 인터페이스를 정의하는 두 가지 방법을 제공한다
  - 인터페이스 내부에 정적 메서드를 사용하는 것
  - 인터페이스의 기본 구현을 제공할 수 있도록 디폴트 메서드 기능을 사용하는 것
- 기존 인터페이스를 구현하는 클래스는 자동으로 인터페이스에 추가된 새로운 메서드의 디폴트 메서드를 상속받게 된다.
- 기존의 코드 구현을 바꾸도록 강요하지 않으면서도 인터페이스를 바꿀 수 있다.

------------------

## 변화하는 API

- 인터페이스에 새로운 메서드를 추가하면 바이너리 호환성은 유지된다.
  - 새로 추가된 메서드를 호출하지만 ㅎ않으면 새로운 메서드 구현이 없이도 기존 클래스 파일 구현이 잘 동작한다는 의미.
- 공개된 API를 고치면 기존 버전과의 호환성 문제가 발생한다.
- 디폴트 메서드로 이 모든 문제를 해결할 수 있다.

-----------------

## 디폴트 메서드란 무엇인가?

- 인터페이스는 자신을 구현하는 클래스에서 메서드를 구현하지 않을 수 있는 새로운 메서드 시그니처를 제공한다.
- 인터페이스가 구현을 가질 수 있고 클래스는 여러 인터페이스를 동시에 구현할 수 잇으므로 결국 자바도 다중 상속을 지원하는 걸까?

### 추상 클래스와 자바 8의 인터페이스

- 둘 다 추상 메서드와 마디를 포함하는 메서드르 정의할 수 있다.
- 하지만 클래스는 하나의 추상 클래스만 상속받을 수 있지만 인터페이스는 여러 개 구현할 수 있다.
- 추상 클래스는 인스턴스 변수(필드)로 공통 상태를 가질 수 있지만 인터페이스는 그럴 수 없다.

------------------

## 디폴트 메서드 활용 패턴

### 선택형 메서드

- 인터페이스를 구현하는 클래스에서 메서드의 내용이 비어있는 상황이 있다.
  - 자주 사용하지 않는 메서드를 구현에서 비워두는 것
- 디폴트 메서드를 사용하면 자주 사용하지 않는 메서드에 기본 구현을 제공할 수 있으므로 클래스에서 빈 구현을 제공할 필요가 없다.

### 동작 다중 상속

- 디폴트 메서드를 이용하면 동작 다중 상속 기능도 구현할 수 있다.
```java
public class ArrayList<E> extends AbstracList<E> implements List<E>, RandomAccess, Cloneable, Serialiable{
        ...
}
```

#### 다중 상속 형식

- 자바 8에서는 인터페이스가 구현을 포함할 수 있으므로 클래스는 여러 인터페이스에서 동작을 상속받을 수 있다.
- 중복되지 않는 최소한의 인터페이스를 유지한다면 코드에서 동작을 쉽게 재사용하고 조합할 수 있다.

------------------

## 해석 규칙

- 같은 시그니처를 갖는 디폴트 메서드를 상속받는 경우 어떤 인터페이스의 디폴트 메서드를 사용하게 될까?
- 자주 일어나지 않는 문제이긴 하지만 일어날 수 있다

### 알아야 할 세 가지 해결 규칙

- 다른 클래스나 인터페이스로부터 같은 시그니처를 갖는 메서드를 상속받을 때는 세 가지 규칙에 따라야 한다

1. 클래스가 항상 이긴다. 클래스나 슈퍼클래스에서 정의한 메서드가 디폴트 메서드보다 우선권을 갖는다
2. 1번 규칙 이외의 상황에서는 서브인터페이스가 이긴다. 상속관계를 갖는 인터페이스에서 같은 시그니처를 갖는 메서드를 정의할 때는 서브 인터페이스가 이긴다.
즉, B가 A를 상속받는다면 B가 A를 이긴다
3. 여전히 디폴트 메서드가 우선순위가 결정되지 않았다면 여러 인터페이스를 상속받는 클래스가 명시적으로 디폴트 메서드를 오버라이드하고 호출해야 한다.

-----------------

## 마치며

- 자바 8의 인터페이스는 구현 코드를 포함하는 디폴트 메서드, 정적 메서드를 정의할 수 있다.
- 디폴트 메서드의 정의는 default 키워드로 시작하며 일반 클래스 메서드처럼 바디를 갖는다.
